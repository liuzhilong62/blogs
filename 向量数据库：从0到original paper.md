



# å‘é‡æ•°æ®åº“ç›¸å…³æ¦‚å¿µ

## äº¿ç‚¹ç‚¹å†å²çŸ¥è¯†

LLMçš„æ¨¡å‹å‘å±•å†å²ï¼Œ[Harnessing the Power of LLMs in Practice: A Survey on ChatGPT and Beyond](https://arxiv.org/pdf/2304.13712)[^0.11]ï¼š

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/2270d4fa2caf45ac8315718da49cc148.png)

å¾ˆå¤šäººéƒ½æ˜¯ä»ChatGPTçˆ†ç‚¹åæ‰é€æ¸äº†è§£åˆ°å¤§æ¨¡å‹ï¼Œä½†åœ¨çˆ†ç‚¹çš„å‰å‡ å¹´å¤§æ¨¡å‹çš„å‘å±•å·²ç»å¼€å§‹äº†è¯¸ç¥ä¹‹æˆ˜ã€‚ä¸€äº›æœºæ„å‘å¸ƒäº†è®¸å¤šé©å‘½æ€§çš„è®ºæ–‡ï¼Œå…¬å¸éƒ¨åˆ†åƒæ˜¯Googleã€DeepMindã€OpenAIã€Metaã€Microsoftï¼Œå­¦æ ¡éƒ¨åˆ†åƒæ˜¯Stanfordã€Berkeleyã€CMUã€Princetonã€MIT[^3]ã€‚

æ€»å…±åˆ†ä¸ºä¸‰ä¸ªé˜µè¥ï¼š 

- Googleå’ŒDeepMindé˜µè¥ â€” Geminiã€Bard
- Microsoftå’ŒOpenAIé˜µè¥ â€”ChatGPTã€Bing
- Metaå¼€æºç¤¾åŒºé˜µè¥ â€” Llama 



è¿‘å‡ å¹´ç°æœ‰å¤§æ¨¡å‹äº§å“å‘å¸ƒæ—¶é—´çº¿[A Survey of Large Language Models](https://arxiv.org/pdf/2303.18223.pdf)[^0.4]ï¼š

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/848d42bc952b4cc8ab4cecc9078bad53.png)





## ç”Ÿæˆå¼AIçš„ç®€å•æ¦‚å¿µ

**AIGCï¼ˆArtificial Intelligence generated Contentï¼‰**ï¼šAIGCç²¾å‡†æ¦‚å¿µæ˜¯åˆ©ç”¨AIè‡ªåŠ¨ç”Ÿæˆå†…å®¹çš„ç”Ÿäº§æ–¹å¼ã€‚å¹¿ä¹‰çš„AIGCå¯ä»¥è¿‘ä¼¼è®­ç»ƒåƒäººç±»ä¸€æ ·å…·å¤‡ç”Ÿæˆåˆ›å»ºèƒ½åŠ›çš„AIæŠ€æœ¯ï¼Œå³ç”Ÿæˆå¼AIï¼Œå®ƒå¯ä»¥åŸºäºæ•°æ®å’Œç”Ÿæˆæ¼”ç®—æ³•æ¨¡å‹ï¼Œè‡ªä¸»ç”Ÿæˆåˆ›å»ºæ–°çš„æ–‡æœ¬ã€å›¾åƒã€éŸ³ä¹ã€è§†é¢‘ã€3Däº¤äº’å†…å®¹ç­‰å„ç§å½¢å¼çš„å†…å®¹å’Œæ•°æ®ï¼Œä»¥åŠåŒ…æ‹¬å¼€å¯ç§‘å­¦æ–°å‘ç°ã€åˆ›é€ æ–°çš„å’Œæ„ä¹‰ç­‰ã€‚



**LLMï¼ˆLarge Language Modelï¼‰**ï¼šLLMå³å¤§è¯­è¨€æ¨¡å‹ï¼ŒLLMèƒ½å¤Ÿæ•æ‰å’Œå¤„ç†å¤æ‚çš„è¯­è¨€æ¨¡å¼å’Œè¯­ä¹‰ï¼Œä¹Ÿå°±æ˜¯å®ƒèƒ½å¤Ÿç†è§£å’Œç”Ÿæˆäººç±»è¯­è¨€ã€‚GPT3ã€ChatGPTã€BERTã€T5ã€æ–‡å¿ƒä¸€è¨€ç­‰éƒ½æ˜¯å…¸å‹çš„å¤§å‹è¯­è¨€æ¨¡å‹ã€‚



**NLPï¼ˆNatural language processingï¼‰**ï¼šè‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNLPï¼‰æ˜¯ç ”ç©¶å¦‚ä½•è®©è®¡ç®—æœºè¯»æ‡‚äººç±»è¯­è¨€ï¼Œä¹Ÿå°±æ˜¯å°†äººçš„è‡ªç„¶è¯­è¨€è½¬æ¢ä¸ºè®¡ç®—æœºå¯ä»¥é˜…è¯»çš„æŒ‡ä»¤ã€‚LLMæ˜¯ NLP ä¸­çš„ä¸€ä¸ªé‡è¦ç»„æˆéƒ¨åˆ†ã€‚



AIGCå–å¾—äº†ä»¤äººç©ç›®çš„å¢é•¿ï¼Œæœ‰å¾ˆå¤§å› ç´ å°±åœ¨äºè‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNLPï¼‰ï¼Œè€Œæ¨åŠ¨NLPå‘å±•çš„æœ€å¤§åŠŸè‡£æ˜¯å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰ã€‚ä»Šå¹´ï¼ˆ2024å¹´ï¼‰AIGCåœ¨è§†é¢‘ã€å£°éŸ³ç­‰é¢†åŸŸä¹ŸåŒæ ·å‘å±•è¿…é€Ÿã€‚[^0.1]



**prompt**ï¼šæç¤ºç¬¦ã€æŒ‡ä»¤ï¼Œæä¾›ç»™AIå¯¹åº”æè¿°ä»»åŠ¡çš„è‡ªç„¶è¯­è¨€ï¼Œç”¨äºå¼•å¯¼è¯­è¨€æ¨¡å‹ï¼ˆå¦‚GPT-3æˆ–GPT-4ï¼‰ç”Ÿæˆç›¸åº”çš„è¾“å‡º[^1]ã€‚ï¼ˆå¤§ä¼™å…¶å®éƒ½çŸ¥é“æ˜¯å•¥äº†ï¼Œä¸å¤šè§£é‡Šï¼‰



**embedding**ï¼š

åµŒå…¥æ˜¯ä¸€ç§è¡¨ç¤ºå¯¹è±¡ï¼ˆå¦‚æ–‡æœ¬ã€å›¾åƒå’ŒéŸ³é¢‘ï¼‰çš„æ–¹æ³•ï¼Œå°†å…¶è¡¨ç¤ºä¸ºè¿ç»­å‘é‡ç©ºé—´ä¸­çš„ç‚¹ï¼Œè¿™äº›ç‚¹åœ¨ç©ºé—´ä¸­çš„ä½ç½®å¯¹æœºå™¨å­¦ä¹ ç®—æ³•å…·æœ‰è¯­ä¹‰ã€‚

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/a637bf03a28c4cbdb760d4723575d771.png)

æ ¹æ®[GloVe](https://nlp.stanford.edu/projects/glove/)è‹±æ–‡å•è¯å’Œå‘é‡ç›¸å…³æ€§ï¼Œè¿™æœ‰ä¸ªå¯[ç›´æ¥çœ‹è¯æ±‡embeddingåçš„äºŒç»´å›¾](https://blog.echen.me/embedding-explorer/#/)ã€‚è¿™ä¸ªå°±æ˜¯è‡ªç„¶è¯­è¨€åµŒå…¥ä¸ºäºŒç»´å‘é‡ï¼š

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/6d88a1a8bdd743b4bc6396b66f800d31.png)





## RAG

RAG(Retrieval-Augmented Generation)æ˜¯ä¸€ä¸ªåŒ…å«æ–‡æ¡£æ£€ç´¢å’Œå¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰å›ç­”ç”Ÿæˆçš„ä¸¤é˜¶æ®µè¿‡ç¨‹ã€‚åˆå§‹é˜¶æ®µåˆ©ç”¨å¯†é›†åµŒå…¥æ¥æ£€ç´¢æ–‡æ¡£ã€‚æ ¹æ®å…·ä½“ä½¿ç”¨åœºæ™¯ï¼Œè¿™ç§æ£€ç´¢å¯ä»¥åŸºäºå¤šç§æ•°æ®åº“æ ¼å¼ï¼Œä¾‹å¦‚å‘é‡æ•°æ®åº“ã€æ‘˜è¦ç´¢å¼•ã€æ ‘ç´¢å¼•ã€keyç´¢å¼•[^1]ã€‚

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/c80ad5a4889f4a038da279a8a4ac4851.png)

[RAGåŸå§‹è®ºæ–‡](https://arxiv.org/pdf/2005.11401)[^2]æ˜¯2020å¹´5æœˆ22æ—¥å‘å¸ƒï¼Œæ¥è‡ªFacebook(Meta)ã€ä¼¦æ•¦å¤§å­¦å­¦é™¢ã€çº½çº¦å¤§å­¦çš„äººå‘˜æå‡ºRAGçš„é€šç”¨å¾®è°ƒæ–¹æ³• ã€‚RAGåŒ…å«å¦‚ä¸‹ç‰¹æ€§[^3]

- RAGæ¨¡å‹ç»“åˆäº†é¢„è®­ç»ƒçš„è®°å¿†ä»¥å¸®åŠ©è¯­è¨€çš„ç”Ÿæˆ
- RAGæ¨¡å‹ç”Ÿæˆçš„è¯­è¨€æ›´åŠ å…·ä½“ã€å¤šæ ·ä¸”å…·æœ‰äº‹å®æ€§

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/31764e1c55f447a591329119c115f726.png)



OpenAIåœ¨2023å¹´3æœˆ23æ—¥å‘å¸ƒçš„[chatgpt-retrieval-plugin](https://github.com/openai/chatgpt-retrieval-plugin)ä»“åº“æ¨èåœ¨RAGä¸­ä½¿ç”¨å‘é‡æ•°æ®åº“ï¼Œä»æ­¤åœ¨åº”ç”¨é¢†åŸŸå‘é‡æ•°æ®åº“è·Ÿéšå¤§æ¨¡å‹çš„çˆ†ç«è€Œå¤‡å—å…³æ³¨

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/7b7aac95dce14a76bde81da9b808d0c5.png)



## å‘é‡æ•°æ®åº“èƒ½ä¸ºAIå¸¦æ¥ä»€ä¹ˆï¼Ÿ

å‘é‡æ•°æ®åº“èƒ½åœ¨RAGä¸­ä¸ºå¤§æ¨¡å‹æä¾›æ•°æ®æ£€ç´¢å’Œæ•°æ®é•¿æœŸå­˜å‚¨çš„èƒ½åŠ›[^x]

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/8196a28659164fc2999cfa0cff93db6e.png)

ä¸ºä»€ä¹ˆè¦ä½¿ç”¨RAGï¼Ÿä»»ä½•è¯è¯­éƒ½æ²¡æœ‰ç¥–å¸ˆçˆ·OpenAIè¯´è¯æœ‰åŠ›ã€‚ä¸‹é¢ä¸€æ®µè¯æºè‡ª2023å¹´3æœˆOpenAIçš„å‘å¸ƒçš„æ£€ç´¢æ’ä»¶ä½¿ç”¨æŒ‡å¼•[^55]ï¼Œç”¨ChatGPTç¿»è¯‘å¦‚ä¸‹ï¼š

> å¼€æºæ£€ç´¢æ’ä»¶ä½¿ ChatGPT èƒ½å¤Ÿè®¿é—®ä¸ªäººæˆ–ç»„ç»‡çš„ä¿¡æ¯æºï¼ˆéœ€è·å¾—è®¸å¯ï¼‰ã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡è‡ªç„¶è¯­è¨€æé—®æˆ–è¡¨è¾¾éœ€æ±‚ï¼Œä»å…¶æ•°æ®æºï¼ˆå¦‚æ–‡ä»¶ã€ç¬”è®°ã€ç”µå­é‚®ä»¶æˆ–å…¬å…±æ–‡æ¡£ï¼‰ä¸­è·å–æœ€ç›¸å…³çš„æ–‡æ¡£ç‰‡æ®µã€‚
>
> ä½œä¸ºå¼€æºä¸”è‡ªæ‰˜ç®¡çš„è§£å†³æ–¹æ¡ˆï¼Œå¼€å‘è€…å¯ä»¥éƒ¨ç½²ä»–ä»¬è‡ªå·±çš„æ’ä»¶ç‰ˆæœ¬å¹¶æ³¨å†Œåˆ° ChatGPT ä¸Šã€‚è¯¥æ’ä»¶åˆ©ç”¨ OpenAI çš„åµŒå…¥æŠ€æœ¯ï¼Œå¹¶å…è®¸å¼€å‘è€…é€‰æ‹©ä¸€ä¸ªçŸ¢é‡æ•°æ®åº“ï¼ˆå¦‚ Milvusã€Pineconeã€Qdrantã€Redisã€Weaviate æˆ– Zillizï¼‰æ¥ç´¢å¼•å’Œæœç´¢æ–‡æ¡£ã€‚ä¿¡æ¯æºå¯ä»¥ä½¿ç”¨ webhook ä¸æ•°æ®åº“åŒæ­¥ã€‚

æ€»ä¹‹ï¼ŒOpenAIæ¨èå¤§ä¼™ä½¿ç”¨å‘é‡æ•°æ®åº“ã€‚

[å‘é‡æ•°æ®åº“å‡‰äº†å—ï¼Ÿ](https://mp.weixin.qq.com/s/0eBZ4zyX6XjBQO0GqlANnw)ä¸ä»…æ²¡æœ‰å‡‰ï¼ŒRAGå‘å±•åˆ°ä»Šå¤©ï¼Œç”šè‡³éƒ½å·²ç»çƒ‚å¤§è¡—äº†--[RAG æŠ€æœ¯çœŸçš„â€œçƒ‚å¤§è¡—â€äº†å—ï¼Ÿ](https://mp.weixin.qq.com/s/awIInAtPOkZz_s4jg9TO_w)ã€‚è€Œå‘é‡æ•°æ®åº“å› å…·æœ‰é«˜æ£€ç´¢æ•ˆç‡ã€æ•°æ®å­˜å‚¨å¯é æ€§ç­‰ç­‰ç‰¹ç‚¹ï¼Œæ˜¯RAGçš„é‡è¦ä¸€ç¯ã€‚



## å¸¸è§çš„å‘é‡æ•°æ®åº“

è‡ªä»OpenAIå‘å¸ƒRAG repoä»¥æ¥ï¼Œå‡ºç°äº†è®¸å¤šå‘é‡æ•°æ®åº“ï¼ˆå½“ç„¶ä»¥å‰ä¹Ÿæœ‰ä¸€äº›ï¼‰ã€‚ä¸€äº›å…¬å¸ä¹Ÿæ‹¿åˆ°äº†ç›¸å½“å¯è§‚çš„èèµ„[^y]

| Company       | Headquartered in     | Funding        |
| :------------ | :------------------- | :------------- |
| Weaviate      | ğŸ‡³ğŸ‡± Amsterdam         | $68M Series B  |
| Qdrant        | ğŸ‡©ğŸ‡ª Berlin            | $11M Seed      |
| Pinecone      | ğŸ‡ºğŸ‡¸ San Francisco     | $138M Series B |
| Milvus/Zilliz | ğŸ‡¨ğŸ‡³ / ğŸ‡ºğŸ‡¸ Redwood City | $113M Series B |
| Chroma        | ğŸ‡ºğŸ‡¸ San Francisco     | $20M Seed      |
| LanceDB       | ğŸ‡ºğŸ‡¸ San Francisco     | Venture        |
| Vespa         | ğŸ‡³ğŸ‡´ / ğŸ‡ºğŸ‡¸ Indianapolis | Yahoo!         |
| Vald          | ğŸ‡¯ğŸ‡µ Tokyo             | Yahoo! Japan   |

å‘é‡æ•°æ®åº“å‘å¸ƒæ—¶é—´ï¼š

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/ab0ff27930004b80b3ff58bbdd90c382.png)

[å‘é‡æ•°æ®åº“æ€§èƒ½å¯¹æ¯”](https://github.com/erikbern/ann-benchmarks)[^yy]ï¼š

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/5d9cd531b116496cb6e5df6cfc709725.png)

ä¸“ç”¨å‘é‡æ•°æ®åº“ä¸€èˆ¬æ¥è¯´æ¯”æ’ä»¶æ¥å®ç°å‘é‡çš„ä¼ ç»Ÿæ•°æ®åº“æ€§èƒ½æ›´å¥½ï¼ŒåŸå› å¤§æ¦‚æœ‰ä¸¤ç‚¹ï¼š

- ä¸“ç”¨å‘é‡æ•°æ®åº“é’ˆå¯¹å‘é‡åšçš„åº•å±‚å­˜å‚¨ï¼Œå…¶æ€§èƒ½ä¸€èˆ¬éƒ½è¦å¥½äºæ— ç›®æ ‡æ€§çš„ä¼ ç»Ÿæ•°æ®åº“
- ä¸“ç”¨å‘é‡æ•°æ®åº“ä¸€èˆ¬æ›´æ–°ï¼ˆåŸºæœ¬éƒ½æ˜¯goã€rustå®ç°çš„ï¼‰ï¼Œä»–ä»¬åœ¨ä»£ç å®ç°å±‚é¢æ›´æ–¹ä¾¿ä¼˜åŒ–



ä½†è¿™ä¸ä»£è¡¨æ’ä»¶å®ç°çš„å‘é‡æ•°æ®åº“æ²¡æœ‰ç”¨æ­¦ä¹‹åœ°ï¼š

- ä¼ ç»Ÿæ•°æ®åº“åŸç”Ÿå°±æ”¯æŒæ›´å¤šåŠŸèƒ½ï¼Œä¸ä»…ä»…æ˜¯ç›¸ä¼¼åº¦è®¡ç®—
- ACIDï¼Œä¼ ç»Ÿæ•°æ®åº“çš„å­˜å‚¨æ›´ä¸ºå®‰å…¨
- åœ¨åŒä¸€ä¸ªæ•°æ®åº“ä¸­æ›´å®¹æ˜“æ“ä½œæ•°æ®



å‘é‡æ•°æ®åŠŸèƒ½å¯¹æ¯”ï¼š

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/5a8e0cd6789b406abe5208a6e09967f0.png)

ä¸Šé¢å¯¹pgvector](https://github.com/pgvector/pgvector)çš„æè¿°ä¸å¤ªå‡†ç¡®äº†ï¼Œpgvectorç›®å‰å·²ç»æ”¯æŒäº†HNSWï¼ŒåŸºäºpgvectorçš„ç”Ÿæ€[pgvectorscale](https://github.com/timescale/pgvectorscale)ä¹Ÿæ”¯æŒäº†DiskANNã€‚



# æ•°å­¦ç›¸å…³æ¦‚å¿µ

*æ•°å­¦è¯´ï¼šâ€œæˆ‘ç«™åœ¨å±±é¡¶çœ‹ä½ ä»¬ç©â€*

### **æ ‡é‡**

æ ‡é‡å°±æ˜¯å…·ä½“çš„æ•°ã€‚æ ‡é‡æ²¡æœ‰æ–¹å‘ï¼Œä¸€èˆ¬æ˜¯ç›¸å¯¹å‘é‡æ¥å®šä¹‰çš„ã€‚

### **å‘é‡ï¼ˆvectorï¼‰**

åœ¨æ¬§å‡ é‡Œå¾—ç©ºé—´ä¸­ï¼Œå‘é‡åŒ…æ‹¬é•¿åº¦å’Œæ–¹å‘ã€‚å¦‚ä¸‹ç‚¹*A*åˆ°ç‚¹*B*çš„å‘é‡**a**ï¼ˆåŒ…å«ä¸¤ä¸ªç‚¹çš„ä¿¡æ¯ï¼Œå’Œæ–¹å‘ä¿¡æ¯ï¼‰[^10]ï¼š

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/888104b4e98a4a4a8fe5a04de5bcfc05.png)

### **å•ä½å‘é‡ï¼ˆUnit vectorï¼‰**

å¤§å°ä¸ºä¸€ä¸ªå•ä½çš„å‘é‡å°±æ˜¯å•ä½å‘é‡ã€‚å•ä½å‘é‡ç­‰äºå‘é‡é™¤ä»¥æ¬§å‡ é‡Œå¾—é•¿åº¦[^11]ï¼š
$$
\vec a = \frac{\mathbf a}{||\mathbf a||}
$$

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/2fd36035e8d146778b4316ae2c3fba17.png)

æ•°å­¦ä¸­çš„å•ä½å‘é‡ï¼ˆ[Unit vector](https://en.wikipedia.org/wiki/Unit_vector)ï¼‰åœ¨pgvectorå’ŒOpenAI embeddingsä¸­è¢«ç§°ä¸ºnormalized vectorã€‚ï¼ˆæ³¨æ„ï¼Œä¸è¦è·Ÿæ•°å­¦ä¸­çš„normal vectoræ··æ·†ï¼Œ[normal vector](https://en.wikipedia.org/wiki/Normal_(geometry))æ˜¯æ³•å‘é‡ï¼Œæ˜¯å¦ä¸€ä¸ªæ¦‚å¿µï¼‰

*ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å•ä½å‘é‡ï¼Ÿ*

OpenAI embeddingså¯¹ä½¿ç”¨å•ä½å‘é‡çš„è§£é‡Š[^12]:

>OpenAI embeddings are normalized to length 1, which means that:
>
>- Cosine similarity can be computed slightly faster using just a dot product
>- Cosine similarity and Euclidean distance will result in the identical rankings



### **ç¨€ç–å‘é‡ï¼ˆsparse vectorï¼‰**

ç¨€ç–å‘é‡ä¹‹æ‰€ä»¥ç§°ä¸ºç¨€ç–å‘é‡ï¼Œæ˜¯å› ä¸ºå‘é‡ä¸­çš„ä¿¡æ¯åˆ†å¸ƒç¨€ç–ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æˆåƒä¸Šä¸‡ä¸ªé›¶ä¸­æ‰¾åˆ°å‡ ä¸ª1ï¼ˆç›¸å…³ä¿¡æ¯ï¼‰ã€‚å› æ­¤ï¼Œè¿™äº›å‘é‡å¯ä»¥åŒ…å«è®¸å¤šç»´åº¦ï¼Œé€šå¸¸åœ¨æ•°ä¸‡ä¸ªç»´åº¦ã€‚

ç¨€ç–å‘é‡å’Œå¯†é›†å‘é‡çš„æ¯”è¾ƒã€‚ç¨€ç–å‘é‡åŒ…å«ç¨€ç–åˆ†å¸ƒçš„ä¿¡æ¯ä½ï¼Œè€Œå¯†é›†å‘é‡åœ¨æ¯ä¸ªç»´åº¦ä¸Šéƒ½åŒ…å«æ›´å¤šä¿¡æ¯ï¼Œä¿¡æ¯å¯†é›†ã€‚[^13]

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/b075ec5d468f43418ce09a13479ae492.png)



### **æ¬§å‡ é‡Œå¾—ç©ºé—´ï¼ˆEuclidean spaceï¼‰**

ç®€ç§°æ¬§å¼ç©ºé—´ï¼Œæ˜¯æ•°å­¦ä¸­æœ€åŸºæœ¬çš„ç©ºé—´ã€‚ç°ä»£æ•°å­¦ä¸­ï¼Œæ­£æ•´æ•°nç»´çš„ç©ºé—´ç§°ä¸ºæ¬§å‡ é‡Œå¾—ç©ºé—´ã€‚

è¿˜æœ‰ä¸€äº›å…¶ä»–çš„ç©ºé—´å®šä¹‰ï¼Œå¦‚å†…ç§¯ç©ºé—´ã€å¸Œå°”ä¼¯ç‰¹ç©ºé—´ï¼Œå®ƒä»¬åœ¨æ•°å­¦å®šä¹‰ä¸Šæœ‰ä¸åŒï¼Œä½†æ˜¯åœ¨æ•°æ®åº“/çœŸå®ä¸–ç•Œä¸­ä¸ä¼šåˆ†é‚£ä¹ˆæ¸…æ¥šï¼ŒåŸºæœ¬è¦çŸ¥é“çš„æ˜¯å†…ç§¯ç©ºé—´ã€æ¬§å‡ é‡Œå¾—ç©ºé—´ã€å¸Œå°”ä¼¯ç‰¹ç©ºé—´éƒ½å¯ä»¥åŒ…å«ç‚¹ã€å‘é‡ã€å†…ç§¯ç­‰å…ƒç´ ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•çš„ç§°ä»–ä»¬ä¸ºâ€œ**å¤šç»´ç©ºé—´**â€ã€‚å®ƒä»¬çš„åŒºåˆ«å¯å‚è€ƒ[æ¼«è°ˆæ•°å­¦ä¸­çš„å„ç§ç©ºé—´](https://zhuanlan.zhihu.com/p/684643954)[^14]

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/2faddd78735742a9a151b6d2edf4663a.png)





### **æ¬§å‡ é‡Œå¾—è·ç¦»(Euclidean distance)**

ç®€ç§°æ¬§å¼è·ç¦»ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¸€èˆ¬è®¤ä¸ºçš„ç‚¹ä¸ç‚¹çš„è·ç¦»ï¼Œå³çº¿æ®µçš„é•¿åº¦[^15]

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/fa5f70c0868d4d8eaad0e33a1ad1a67d.png)



åœ¨äºŒç»´ç©ºé—´ä¸­ï¼Œç‚¹qä¸ç‚¹pçš„æ¬§å¼è·ç¦»ä¸ºï¼š
$$
d(\mathbf p,\mathbf q)=\sqrt{(p_1-q_1)^2+(p_2-q_2)^2}
$$


åœ¨nç»´ç©ºé—´ä¸­ï¼Œç‚¹qä¸ç‚¹pçš„æ¬§å¼è·ç¦»ä¸ºï¼š
$$
d(\mathbf p,\mathbf q)=\sqrt{(p_1-q_1)^2+(p_2-q_2)^2+\cdots+(p_n-q_n)^2}
$$



### **æ›¼å“ˆé¡¿è·ç¦»ï¼ˆManhattan distance OR Taxicab distanceï¼‰**

$$
d(\mathbf p,\mathbf q)=  \sum_{i=1}^n |  p_i-q_i|
$$

æ›¼å“ˆé¡¿è·ç¦»æ˜¯ä¸¤ä¸ªç‚¹åœ¨å„ä¸ªç»´åº¦ä¸Šçš„å·®çš„ç»å¯¹å€¼ä¹‹å’Œ[^16]

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/d193798b2a6c4546a3b07aa22eed5ee6.png)

ä¸Šå›¾ä¸­ï¼Œç»¿çº¿ä¸ºæ¬§å¼è·ç¦»ï¼Œçº¢ã€é»„ã€è“çº¿ä¸ºæ›¼å“ˆé¡¿è·ç¦»ã€‚



### **é—µæ°è·ç¦»(Minkowski distance)**

$$
d(\mathbf a,\mathbf b)= \left( \sum_{i=1}^n |  a_i-b_i|^p \right)^{1/p}
$$

ä¸‹å›¾è¡¨ç¤ºåœ¨é—µå¼è·ç¦»ä¸­å–ä¸åŒçš„pæ—¶ï¼Œå•ä½é•¿åº¦çš„ç‚¹åˆ°åŸç‚¹çš„è·ç¦»[^17]ï¼š

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/6d4a0669aff84fdfb1698eb110416220.png)

- å½“p=1æ—¶ï¼Œä¸ºæ›¼å“ˆé¡¿è·ç¦»ï¼Œä¹Ÿå†™ä½œâ€œL1 distanceâ€

- å½“p=2æ—¶ï¼Œä¸ºæ¬§å¼è·ç¦»ï¼Œä¹Ÿå†™ä½œâ€œL2 distanceâ€
- å½“p=næ—¶ï¼Œä¸ºé—µå¼è·ç¦»ï¼Œä¹Ÿå†™ä½œâ€œLn distanceâ€



### **ä½™å¼¦ç›¸ä¼¼æ€§ï¼ˆCosine similarityï¼‰**

å³ä¸¤ä¸ªå‘é‡çš„å¤¹è§’çš„cosineå€¼ï¼Œä¹Ÿå«ä½™å¼¦å€¼ã€‚ä½™å¼¦ç›¸ä¼¼æ€§åªè·Ÿä¸¤ä¸ªå‘é‡çš„å¤¹è§’æœ‰å…³ç³»ï¼Œè·Ÿå‘é‡çš„é•¿åº¦æ— å…³[^18]

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/9bff6a982e2b4a8b95840b89d6520069.png)

ä¸¤ä¸ªå‘é‡è§’åº¦è¶Šå°ï¼Œä½™å¼¦ç›¸ä¼¼æ€§è¶Šå¤§ï¼Œå€¼åŸŸ[-1,1]ã€‚cos(0)=1ï¼Œcos(90)=0ï¼Œcos(180)=-1ã€‚



ä¸¤ä¸ªå‘é‡çš„ä½™å¼¦ç›¸ä¼¼æ€§å†™ä½œï¼š
$$
cos (\theta)
$$
ç”¨å‘é‡è¡¨ç¤ºï¼š
$$
cos (\theta)=\frac{\mathbf a\cdot \mathbf b }{||\mathbf a|| \, ||\mathbf b||}= \frac{ \sum_{i=1}^n \mathbf a_i \mathbf b_i}{ \sqrt {\sum_{i=1}^n \mathbf a_i ^2} \cdot  \sqrt {\sum_{i=1}^n \mathbf b_i ^2}}
$$


![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/66c36d0b08b4434ca5e88c5406a0fabf.png)





### **å†…ç§¯ï¼ˆ inner productï¼‰**

ä¹Ÿç§°ä¸ºç‚¹ç§¯ï¼ˆDot productï¼‰ï¼Œå¯ä»¥è¢«ç”¨æ¥è¡¨ç¤ºå‘é‡çš„é•¿åº¦å’Œè§’åº¦ã€‚å†…ç§¯ç­‰äºå‘é‡çš„*æ¬§å‡ é‡Œå¾—è·ç¦»*ä¹˜ä»¥*å¤¹è§’ä½™å¼¦å€¼*ã€‚

äºŒç»´ç©ºé—´ä¸­çš„å†…ç§¯ä¸ºï¼š
$$
\mathbf a\cdot \mathbf b=||\mathbf a|| \, ||\mathbf b||\,  cos \theta
$$
or
$$
\mathbf a\cdot \mathbf b= a_1 b_1 + a_2 b_2
$$
åœ¨nç»´ç©ºé—´ä¸­çš„å†…ç§¯ä¸ºï¼ˆ**a**=[a1,a2,Â·Â·Â·,an],**b**=[b1,b2,Â·Â·Â·,bn]ï¼‰ï¼š
$$
\mathbf a\cdot \mathbf b=\sum_{i=1}^n a_ib_i= a_1b_1 + a_2b_2 + \cdots + a_nb_n
$$




æ­¤æ—¶æ¥çœ‹ä¸‹é¢è¿™ä¸ªå›¾å°±èƒ½çœ‹æ‡‚äº†ã€‚ç”¨ä¸Šé¢çš„å…¬å¼ä¹Ÿå¯åæ¨nç»´å‘é‡çš„è·ç¦»æ“ä½œç¬¦çš„å«ä¹‰ã€‚

ä»–ä»¬åˆ†åˆ«æ˜¯ï¼šæ¬§å‡ é‡Œå¾—è·ç¦»ï¼Œä½™å¼¦è·ç¦»ï¼Œå†…ç§¯[^19]

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/151c8f26130f41d3b668407f920234d1.png)

ä»–ä»¬éƒ½å¯ä»¥æè¿°ä¸¤ä¸ªå‘é‡çš„ç›¸ä¼¼æ€§ã€‚

- æ¬§å‡ é‡Œå¾—è·ç¦»ä»…åŒ…å«ä¸¤ä¸ªå‘é‡çš„è·ç¦»ä¿¡æ¯
- ä½™å¼¦è·ç¦»ï¼šä»…åŒ…å«ä¸¤ä¸ªå‘é‡çš„è§’åº¦ä¿¡æ¯
- å†…ç§¯ï¼šæ—¢åŒ…å«è·ç¦»ä¿¡æ¯ï¼Œä¹ŸåŒ…å«è§’åº¦ä¿¡æ¯

å½“ç„¶è¿˜æœ‰æ›´å¤šæ•°å­¦æ¨¡å‹ä¸Šçš„å‘é‡ç›¸ä¼¼æ€§è®¡ç®—æ–¹æ³•ï¼Œä¸è¿‡è¦çœ‹å‘é‡æ•°æ®åº“æ”¯ä¸æ”¯æŒã€‚



### **jaccardè·ç¦»**

ç®€è€Œè¨€ä¹‹ï¼Œäº¤é›†é™¤ä»¥å¹¶é›†[^20]



![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/1d1b2da25b724ffe938d3eb8e3b0f24c.png)

ç”¨å…¬å¼è¡¨è¾¾ï¼š
$$
J(A,B)=  \frac{|A\cap B| }{|A \cup B|}
$$


ç”¨å‘é‡è¡¨è¾¾ï¼Œå³è®¡ç®—ä¸¤ä¸ªç›¸ç­‰å…ƒç´ ä¸ªæ•°å’Œä¸ç›¸ç­‰å…ƒç´ ä¸ªæ•°çš„æ¯”[^79]

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/7ee329f945b045c6b3627742b358382b.png)

### **Hammingè·ç¦»**

ä¸¤ä¸ªç›¸åŒé•¿åº¦çš„å­—ç¬¦ä¸²æˆ–å‘é‡åœ¨å„è‡ªä½ç½®ä¸Šçš„ä¸åŒæ•°é‡[^22]

ä¾‹å­ï¼š

- "ka**rol**in" and "ka**thr**in" is 3.
- "k**a**r**ol**in" and "k**e**r**st**in" is 3.
- "k**athr**in" and "k**erst**in" is 4.
- **0000** and **1111** is 4.
- 2**17**3**8**96 and 2**23**3**7**96 is 3.



å›¾ä¾‹[^23]ï¼š

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/c95f9b573365451082e0995d0000f777.png)



### **Delaunayä¸‰è§’å‰–åˆ†**

Delaunayä¸‰è§’å‰–åˆ†æ˜¯å¯¹å¹³é¢ä¸Šä¸€ç»„ç‚¹é›†è¿›è¡Œçš„æ“ä½œï¼Œå®ƒå°†è¿™äº›ç‚¹é›†çš„å‡¸åŒ…ï¼ˆåŒ…å«å¤šä¸ªç‚¹ï¼‰ç»†åˆ†ä¸ºå¤šä¸ªä¸‰è§’å½¢ï¼Œè¿™äº›ä¸‰è§’å½¢çš„å¤–æ¥åœ†ä¸åŒ…å«ä»»ä½•ç‚¹é›†ä¸­çš„ç‚¹ã€‚è¿™æ ·åšæœ€å¤§åŒ–äº†æ‰€æœ‰ä¸‰è§’å½¢ä¸­æœ€å°è§’çš„å¤§å°ï¼Œå¹¶å€¾å‘äºé¿å…äº§ç”Ÿç»†é•¿çš„ä¸‰è§’å½¢[^24]ã€‚

ä¸æ»¡è¶³ ä¸‰è§’å½¢çš„å¤–æ¥åœ†ä¸åŒ…å«ä»»ä½•ç‚¹é›†ä¸­çš„ç‚¹ï¼š

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/e1101a2366e34c98aa0582f9e2520a3b.png)

æ»¡è¶³ ä¸‰è§’å½¢çš„å¤–æ¥åœ†ä¸åŒ…å«ä»»ä½•ç‚¹é›†ä¸­çš„ç‚¹ï¼š

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/0ece301d99de432a9aa0ea6d040f3e50.png)



ä¾‹å¦‚å‰–åˆ†ä¸€ä¸‹ç‚¹é›†ï¼š



![img](https://img-blog.csdnimg.cn/img_convert/589ef882cc21081d350299ecdeb8f1f5.webp?x-oss-process=image/format,png)

åˆç†çš„å‰–åˆ†ï¼š

![img](https://img-blog.csdnimg.cn/img_convert/6663fe885724df154c0ca78d964d7bae.webp?x-oss-process=image/format,png)



Delaunayä¸‰è§’å‰–åˆ†å…¶å®å¹¶ä¸æ˜¯ä¸€ç§ç®—æ³•ï¼Œå®ƒåªæ˜¯ç»™å‡ºäº†ä¸€ä¸ªâ€œå¥½çš„â€ä¸‰è§’ç½‘æ ¼çš„å®šä¹‰ï¼Œå®ƒçš„ä¼˜ç§€ç‰¹æ€§æ˜¯ç©ºåœ†ç‰¹æ€§å’Œæœ€å¤§åŒ–æœ€å°è§’ç‰¹æ€§ï¼Œè¿™ä¸¤ä¸ªç‰¹æ€§é¿å…äº†ç‹­é•¿ä¸‰è§’å½¢çš„äº§ç”Ÿï¼Œä¹Ÿä½¿å¾—Delaunayä¸‰è§’å‰–åˆ†åº”ç”¨å¹¿æ³›ã€‚



### **voronoi diagram**

Delaunayä¸‰è§’å‰–åˆ†ï¼ˆDelaunay triangulationï¼‰æ˜¯ä¸€ä¸ªåœ¨ä¸€èˆ¬ä½ç½®ä¸­çš„ç¦»æ•£ç‚¹é›†Pçš„ä¸‰è§’å‰–åˆ†ï¼Œå®ƒå¯¹åº”äºPçš„Voronoiå›¾çš„å¯¹å¶å›¾ã€‚Delaunayä¸‰è§’å½¢çš„å¤–æ¥åœ†å¿ƒæ˜¯Voronoiå›¾çš„é¡¶ç‚¹ã€‚åœ¨äºŒç»´æƒ…å†µä¸‹ï¼ŒVoronoiçš„é¡¶ç‚¹é€šè¿‡è¾¹è¿æ¥ï¼Œè¿™äº›è¾¹å¯ä»¥é€šè¿‡Delaunayä¸‰è§’å½¢çš„é‚»æ¥å…³ç³»å¾—å‡ºï¼šå¦‚æœä¸¤ä¸ªä¸‰è§’å½¢åœ¨å¾·åŠ³å†…å‰–åˆ†ä¸­å…±äº«ä¸€æ¡è¾¹ï¼Œé‚£ä¹ˆå®ƒä»¬çš„å¤–æ¥åœ†å¿ƒåœ¨Voronoié•¶åµŒä¸­åº”è¯¥ç”¨ä¸€æ¡è¾¹è¿æ¥èµ·æ¥[^25]ï¼š

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/714f4464a9b34cf99eef4bda804904aa.png)



Voronoiå›¾çš„ä¸»è¦ç‰¹æ€§æ˜¯ï¼š*ä»ä¸€ä¸ªè´¨å¿ƒåˆ°å…¶åŒºåŸŸå†…ä»»ä½•ç‚¹çš„è·ç¦»éƒ½å°äºè¯¥ç‚¹åˆ°å¦ä¸€ä¸ªè´¨å¿ƒçš„è·ç¦»*ã€‚
$$
R_k=\{x \in X \,|\,d(x,P_k) \le d(x,P_j) \; \mathrm{for \,all }\,j \neq k\}
$$
Rkæ˜¯è´¨å¿ƒï¼Œd(x,Pk)æ˜¯è´¨å¿ƒåˆ°å…¶åŒºåŸŸå†…ä»»ä½•ç‚¹çš„è·ç¦»ï¼Œd(x,Pj)æ˜¯å…¶ä»–è´¨å¿ƒåˆ°è¯¥åŒºåŸŸä»»ä½•ç‚¹çš„è·ç¦»ã€‚

ç”±äºdè·ç¦»è®¡ç®—æ–¹å¼çš„ä¸åŒï¼ŒVoronoiå›¾è¿˜å¯ä»¥æœ‰ä¸åŒçš„æ ·è²Œ[^26]ï¼š

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/b68ccc0bfbec4f65a15631a0dece0cc9.png)









# å‘é‡æ•°æ®åº“çš„ç´¢å¼•

## é‚»è¿‘æœç´¢

ENNï¼ˆexact nearest neighborï¼‰ï¼šæŒ‡çš„æ˜¯åœ¨ç»™å®šæ•°æ®é›†ä¸­æ‰¾åˆ°ä¸æŸ¥è¯¢ç‚¹æœ€æ¥è¿‘çš„ç‚¹æˆ–å‘é‡ã€‚è¿™ç§æ–¹æ³•ä¿è¯äº†æœ€é«˜çš„ç²¾ç¡®åº¦ï¼Œä½†éšç€æ•°æ®é›†çš„è§„æ¨¡å¢å¤§ï¼Œè®¡ç®—æˆæœ¬ä¼šæ€¥å‰§å‡é«˜ï¼Œå› ä¸ºå®ƒéœ€è¦è¯„ä¼°æŸ¥è¯¢ç‚¹ä¸æ•°æ®é›†ä¸­æ¯ä¸ªç‚¹ä¹‹é—´çš„è·ç¦»ã€‚

ANNï¼ˆApproximate nearest neighborï¼‰ï¼šä¸ºäº†æé«˜æ•ˆç‡ï¼Œåœ¨ç‰ºç‰²ä¸€å®šçš„ç²¾ç¡®åº¦æ¡ä»¶ä¸‹ï¼Œè¿‘ä¼¼çš„æ‰¾åˆ°ä¸æŸ¥è¯¢ç‚¹æœ€è¿‘çš„ç‚¹ã€‚è¿™ç§æ–¹æ³•é€šè¿‡å„ç§ç®—æ³•å®ç°ï¼Œå¯ä»¥å¤§å¤§é™ä½è®¡ç®—æˆæœ¬ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†å¤§è§„æ¨¡æ•°æ®é›†æ—¶æ›´ä¸ºæœ‰æ•ˆã€‚

KNN (K-Nearest Neighbors): è¿™æ˜¯ä¸€ç§å¸¸ç”¨çš„æœºå™¨å­¦ä¹ ç®—æ³•ï¼Œå·¥ä½œåŸç†æ˜¯æ‰¾åˆ°æ•°æ®é›†ä¸­è·ç¦»ç»™å®šæŸ¥è¯¢ç‚¹æœ€è¿‘çš„Kä¸ªé‚»å±…



## ç´¢å¼•è¯„ä»·æ ‡å‡†

è¯„ä»·ä¸€ä¸ªç´¢å¼•çš„å¥½åæ€»æ˜¯ä¾èµ–äºå…·ä½“çš„æ•°æ®æ¨¡å‹çš„ï¼Œæ€»ä½“æ¥è¯´åŒ…å«å¦‚ä¸‹å‡ ç‚¹ï¼š

- æŸ¥è¯¢æ—¶é—´ã€‚æŸ¥è¯¢çš„é€Ÿåº¦æ˜¯éå¸¸å…³é”®çš„ï¼Œåœ¨å¤§æ¨¡å‹ä¸­å°¤ä¸ºé‡è§†ã€‚
- æŸ¥è¯¢è´¨é‡ã€‚ANNæŸ¥è¯¢ä¸ä¼šæ€»æ˜¯è¿”å›æœ€ç²¾å‡†çš„ç»“æœï¼Œä½†æŸ¥è¯¢è´¨é‡ä¹Ÿä¸èƒ½åå·®è¿‡å¤§ï¼Œè€ŒæŸ¥è¯¢è´¨é‡ä¹Ÿæœ‰å¾ˆå¤šæŒ‡æ ‡ï¼Œå…¶ä¸­åŒ…æ‹¬æœ€å¸¸ç”¨çš„å¬å›ç‡ã€‚
- å†…å­˜æ¶ˆè€—ã€‚æŸ¥è¯¢ç´¢å¼•æ‰€æ¶ˆè€—çš„å†…å­˜ï¼Œåœ¨å†…å­˜ä¸ŠæŸ¥æ‰¾æ˜æ˜¾æ¯”åœ¨ç£ç›˜ä¸ŠæŸ¥æ‰¾æ›´å¿«ã€‚
- è®­ç»ƒæ—¶é—´ã€‚æœ‰äº›æŸ¥è¯¢æ–¹æ³•éœ€è¦è®­ç»ƒæ‰èƒ½è¾¾åˆ°è¾ƒå¥½çš„çŠ¶æ€ã€‚
- å†™å…¥æ—¶é—´ã€‚å†™å…¥å‘é‡æ—¶å¯¹ç´¢å¼•çš„å½±å“ï¼Œä»¥åŠåŒ…å«æ‰€æœ‰ç»´æŠ¤ã€‚



å…¶ä¸­å¤§éƒ¨åˆ†æŒ‡æ ‡éƒ½æ¯”è¾ƒå¥½ç†è§£ï¼Œè¿™é‡Œä¸»è¦è®²è§£*æŸ¥è¯¢è´¨é‡*ï¼š

ANNæŸ¥è¯¢ä¸­ï¼Œä¸ä¼šæ€»æ˜¯è¿”å›ç²¾ç¡®çš„ç»“æœã€‚æœç´¢ä¸€ä¸ªå…ƒç´ é›†æ—¶ï¼ŒåŒ…æ‹¬ï¼šæŸ¥è¯¢çš„èŒƒå›´ï¼ˆretrieved elementsï¼‰ã€æ‰€æœ‰æ­£ç¡®å…ƒç´ é›†ï¼ˆrelevant elementsï¼‰ã€è¿”å›çš„æ­£ç¡®å…ƒç´ é›†ï¼ˆtrue postivesï¼‰ã€è¿”å›çš„é”™è¯¯å…ƒç´ é›†ï¼ˆfalse positivesï¼‰[^60]ï¼š

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/4fbbe619b0ed43b592c4e053e1537297.png)



TP = True positive; FP = False positive; TN = True negative; FN = False negative

**å‡†ç¡®ç‡ï¼ˆAccuracyï¼‰**ï¼š
$$
Accuracy=\frac{TP+TN}{TP+FP+TN+FN}
$$
æˆ–å†™æˆï¼š
$$
Accuracy=\frac{æ‰€æœ‰æ­£ç¡®çš„å…ƒç´ }{æ‰€æœ‰å…ƒç´ }
$$






**ç²¾ç¡®ç‡ï¼ˆPrecisionï¼‰**ï¼š
$$
Precision=\frac{TP}{TP+FP}
$$


æˆ–å†™æˆï¼š
$$
Precision=\frac{æ£€ç´¢å‡ºçš„æ­£ç¡®å…ƒç´ }{æ£€ç´¢å‡ºçš„æ‰€æœ‰å…ƒç´ }
$$




**å¬å›ç‡(Recall)**ï¼š
$$
Recall=\frac{TP}{TP+FN}
$$
æˆ–å†™æˆï¼š
$$
Recall=\frac{æ£€ç´¢å‡ºçš„æ­£ç¡®å…ƒç´ }{æ‰€æœ‰æ­£ç¡®çš„å…ƒç´ }
$$




**F-å€¼ï¼ˆF-measureï¼‰**ï¼šç›¸å½“äºåŠ æƒåçš„ç²¾ç¡®ç‡å’Œå¬å›ç‡
$$
Recall=2 \cdot \frac{precision \cdot recall}{precision+recall}
$$


ç¤ºä¾‹ï¼šè€ƒè™‘ä¸€ä¸ªç”¨æ¥è¯†åˆ«æ•°å­—ç…§ç‰‡ä¸­çš„ç‹—ï¼ˆå’Œç›¸å…³å…ƒç´ ï¼‰çš„è®¡ç®—æœºç¨‹åºã€‚åœ¨å¤„ç†ä¸€å¼ åŒ…å«ååªçŒ«å’ŒåäºŒåªç‹—çš„ç…§ç‰‡æ—¶ï¼Œç¨‹åºè¯†åˆ«å‡ºäº†å…«åªç‹—ã€‚åœ¨è¢«è¯†åˆ«ä¸ºç‹—çš„å…«ä¸ªå…ƒç´ ä¸­ï¼Œåªæœ‰äº”ä¸ªå®é™…ä¸Šæ˜¯ç‹—ï¼ˆtrue positivesï¼‰ï¼Œè€Œå…¶ä»–ä¸‰ä¸ªæ˜¯çŒ«ï¼ˆfalse positivesï¼‰ã€‚æœ‰ä¸ƒåªç‹—è¢«æ¼è¯†åˆ«ï¼ˆfalse negativesï¼‰ï¼Œä¸ƒåªçŒ«è¢«æ­£ç¡®æ’é™¤ï¼ˆtrue negativesï¼‰ã€‚é‚£ä¹ˆè¯¥ç¨‹åºçš„

- å‡†ç¡®ç‡=12/(10+12)ï¼ˆè·Ÿè¯†åˆ«ç¨‹åºæœ¬èº«å…³ç³»ä¸å¤§ï¼‰
- ç²¾ç¡®ç‡=5/8ï¼ˆtrue positives/æ£€ç´¢å‡ºçš„æ‰€æœ‰å…ƒç´ ï¼‰
- å¬å›ç‡=5/12ï¼ˆtrue positives/æ‰€æœ‰æ­£ç¡®å…ƒç´ ï¼‰
- Få€¼=2\*[(5/18)\*(5/12)]/[(5/18)\+(5/12)]



##  locality-sensitive hashing (LSH)

LSHæ˜¯ä¸€ç§ç”¨äºé€šè¿‡å°†æ•°æ®å‘é‡è½¬æ¢ä¸ºå“ˆå¸Œå€¼æ¥ç¼©å°æœç´¢èŒƒå›´çš„æ–¹æ³•ï¼ŒåŒæ—¶ä¿ç•™å®ƒä»¬ç›¸ä¼¼æ€§çš„ä¿¡æ¯ã€‚

### LSHçš„æ„å»º

LSHæœ‰è®¸å¤šå®ç°æ–¹å¼ï¼Œè¿™é‡Œä»‹ç»æ¯”è¾ƒä¼ ç»Ÿçš„å®ç°ã€‚è¿™ä¸ªä¼ ç»ŸLSHçš„å®ç°åŒ…å«3ä¸ªéƒ¨åˆ†[^79]

1. Shinglingï¼šå°†åŸå§‹æ–‡æœ¬ç¼–ç ä¸ºå‘é‡ã€‚

2. MinHashingï¼šå°†å‘é‡è½¬æ¢ä¸ºä¸€ç§ç§°ä¸ºsignatureçš„ç‰¹æ®Šè¡¨ç¤ºå½¢å¼ï¼Œç”¨äºæ¯”è¾ƒå®ƒä»¬ä¹‹é—´çš„ç›¸ä¼¼æ€§ã€‚

3. LSH functionï¼šå°†signatureå“ˆå¸Œåˆ°ä¸åŒçš„æ¡¶ä¸­ã€‚å¦‚æœä¸€å¯¹å‘é‡çš„signatureè‡³å°‘æœ‰ä¸€æ¬¡è½å…¥åŒä¸€ä¸ªæ¡¶ä¸­ï¼Œå®ƒä»¬å°±è¢«è®¤ä¸ºæ˜¯å€™é€‰è€…ã€‚

#### Shingling

shinglingæ˜¯ä¸€ç§embeddingæ–¹å¼ï¼ˆä¸ªäººè§‚ç‚¹ï¼‰ã€‚Shinglingå°†è‡ªç„¶è¯­è¨€è¯†åˆ«æˆkä¸ªè¿ç»­çš„tokenï¼Œé‡å¤çš„tokenå°†è¢«å‰”é™¤[^79]ï¼š

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/20221fd8a0a449b2a394ee9db17789c2.png)

æ­¤æ—¶æˆ‘ä»¬æœ‰äº†åŸºäºk-gramçš„tokené›†ï¼Œæ¥ä¸‹æ¥å°±æ˜¯è½¬åŒ–ä¸ºå‘é‡ã€‚

é¦–å…ˆæœ‰ä¸€ä¸ªå…¨â€œ0â€å‘é‡ï¼Œå‘é‡é•¿åº¦ç­‰äºtokené›†çš„é•¿åº¦ã€‚æ¯ä¸ªtokenæ‰€å¯¹åº”çš„å‘é‡çš„ä½ç½®è®¾ç½®ä¸º1ï¼š

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/f3a4f1b44e904e31aa2f399228052ed1.png)

æœ€ç»ˆçš„ç»“æœå°±æ˜¯ï¼Œæˆ‘ä»¬å¾—åˆ°ä¸€ä¸ªå¾ˆé•¿çš„å‘é‡ï¼Œå‘é‡åªæœ‰0ã€1å…ƒç´ ï¼Œå‘é‡ä¿¡æ¯åŒ…å«ä¸€æ¡è¯­å¥çš„è¯­ä¹‰ã€‚



#### MinHashing

ç”±äºå‘é‡ç»´åº¦å®åœ¨å¤ªé«˜ï¼Œç›´æ¥é€šè¿‡one-hot encodingå‡ºæ¥çš„å‘é‡æ¥è®¡ç®—è¿‘ä¼¼è·ç¦»çš„æ•ˆæœéå¸¸å·®ã€‚æˆ‘ä»¬éœ€è¦å°†ç¨€ç–å‘é‡è½¬åŒ–ä¸ºå¯†é›†å‘é‡ï¼Œè¿™ä¸ªè¿‡ç¨‹åœ¨LSHä¸­ç§°ä¸ºMinHashing ï¼Œè½¬åŒ–åçš„å‘é‡ç§°ä¸ºMinHashing signatureã€‚

MinHashingåœ¨åˆå­¦è€…æœ€åˆè®¤è¯†å®ƒçš„æ—¶å€™ä¼šæœ‰ç‚¹éš¾ç†è§£ï¼Œè®¤è¯†äº†ä»¥åä½ ä¼šå‘ç°å®ƒå¾ˆç®€å•ã€‚

> MinHashing is a hash function that permutes the components of an input vector and then returns the first index where the permutated vector component equals 1.



1. é¦–å…ˆæ‰“ä¹±æ’åºï¼ˆpermutationï¼‰ï¼Œå°†ä¸€ä¸ªå‘é‡çš„å…ƒç´ é‡æ–°æ’åˆ—
2. è¿”å›æ’åºåçš„å‘é‡çš„ç¬¬ä¸€ä¸ª1å…ƒç´ çš„index



ä¾‹å¦‚ä»¥ä¸‹ä¾‹å­ï¼š

u1å‘é‡(0,0,1,1,0)ï¼Œç¬¬ä¸€æ¬¡éšæœºæ¢è¡Œåï¼Œå¯¹åº”indexæ˜¯0ï¼Œç¬¬äºŒæ¬¡éšæœºæ¢è¡Œåï¼Œå¯¹åº”çš„indexæ˜¯0[^80]ï¼Œu1ç»è¿‡minhashingåçš„signatureä¸º(0,0)ã€‚

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/24c78809d884458dadfa8ef9422e9f36.png)



å®é™…ä¸Šå¯ä»¥ä½¿ç”¨å¤šä¸ª minhash å€¼æ¥è¿‘ä¼¼æ±‚å¾—å‘é‡ä¹‹é—´çš„ Jaccard ç›¸ä¼¼åº¦ã€‚å®é™…ä¸Šï¼Œä½¿ç”¨çš„ minhash å€¼è¶Šå¤šï¼Œè¿‘ä¼¼å°±è¶Šå‡†ç¡®ã€‚

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/f1e63f852fdd4247a31c1d56751b6602.png)

#### LSH function

å³ä½¿æˆ‘ä»¬å°†ç¨€ç–å‘é‡è½¬åŒ–ä¸ºäº†å¯†é›†å‘é‡ï¼Œä½†æ˜¯å¯†é›†å‘é‡çš„ç»´åº¦ä¹Ÿä¼šå¾ˆé«˜ï¼Œç›´æ¥æ£€ç´¢çš„æ•ˆç‡å¾ˆä½ã€‚

æˆ‘ä»¬å¯ä»¥é€šè¿‡hashè¡¨æ¥æå‡æŸ¥è¯¢æ•ˆç‡ã€‚ä½†æ˜¯è¦æ³¨æ„ï¼Œå¦‚æœç›´æ¥ç”¨éšæœºçš„hashç®—æ³•å®¹æ˜“å°†é‚»è¿‘çš„å‘é‡æ”¾åœ¨ä¸åŒçš„hashæ¡¶ä¸­ï¼Œæˆ‘ä»¬åº”è¯¥æ‰¾ä¸€ä¸ªèƒ½å°†é‚»è¿‘çš„å‘é‡åº”è¯¥æ”¾åœ¨åŒä¸€ä¸ªhashæ¡¶ä¸­çš„hashç®—æ³•ï¼Œè¿™å°±æ˜¯LSHâ€”â€”å±€éƒ¨æ•æ„ŸHASHç®—æ³•ã€‚

> LSH mechanism builds a hash table consisting of several parts which puts a pair of signatures into the same bucket if they have at least one corresponding part.



å±€éƒ¨æ•æ„Ÿhashç®—æ³•çš„ç†å¿µä¹Ÿå¾ˆç®€å•ï¼Œå°†signatureåˆ†ç‰‡ï¼Œåˆ†ç‰‡åçš„å­signatureå„è‡ªè®¡ç®—hashå€¼ï¼Œå­hashå€¼ç¢°æ’çš„åˆ—ä¸ºcandidateã€‚

ä»¥ä¸‹ä¾‹å­æ¯”è¾ƒå®¹æ˜“ç†è§£è‡ªè¡Œé˜…è¯»ï¼š

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/5dc13f95660b40c2ac98240f7d08a123.png)

ä»æé™è§’åº¦æ€è€ƒï¼Œb=1å°±æ˜¯ä¸åˆ†ç‰‡ç›´æ¥hashï¼Œå®Œå…¨æ²¡æœ‰å‘æŒ¥LSHçš„æ•ˆæœï¼›b=signatureçš„å…ƒç´ ä¸ªæ•°ï¼Œæ¯ä¸ªå…ƒç´ ä¸€ä¸ªåˆ†ç‰‡ï¼Œä¹Ÿå°±æ˜¯æ¯ä¸ªå…ƒç´ ä¸€ä¸ªhashå€¼ï¼Œå¯ä»¥åšåˆ°æ¯”è¾ƒç²¾ç¡®çš„è¿‘ä¼¼æ¯”è¾ƒï¼Œä½†æ˜¯å¯¹è®¡ç®—é‡å’Œå†…å­˜æ˜¯æå¤§çš„è´Ÿæ‹…ã€‚



### LSHå‚æ•°ä¸é”™è¯¯ç‡

ä¸€ä¸ªå‘é‡çš„candidateå‘é‡æ¦‚ç‡ç›´æ¥å½±å“å¬å›ç‡ã€‚candidateå‘é‡çš„æ¦‚ç‡å¦‚ä¸‹ï¼Œå…¶ä¸­

- sä»£è¡¨è¿‘ä¼¼åº¦
- bä»£è¡¨åˆ†ç‰‡æ•°

- rä»£è¡¨æ¯ä¸ªåˆ†ç‰‡ä¸­çš„è¡Œæ•°

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/0fdf9f2f34b54f46b0de21ecb6f15a8f.png)



å¦‚æœå°†På’Œsä½œä¸ºå¯¹æ¯”åæ ‡ï¼Œæ ¹æ®å…¬å¼ï¼Œå…¶å‘é‡ç›¸ä¼¼åº¦å’Œcandidateæ¦‚ç‡å…³ç³»å¦‚ä¸‹ï¼š



![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/5be02245ffc340a293f61975c5372734.png)

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/6b90e29c8c5e4d73b084d60e62d73c93.png)

åˆ†åŒºä¸ªæ•°bè¶Šå¤§ï¼Œcandidateç›¸ä¼¼æ¦‚ç‡è¶Šå°ã€‚

åŒæ—¶ï¼Œè°ƒæ•´bå’Œsä¼šå½±å“Pï¼ŒPçš„å€¼ä¸FPã€TNåˆæœ‰å…³ç³»ã€‚

ä¾‹å¦‚è¿”å›æ›´å¤šçš„candidatesï¼Œè¿™è‡ªç„¶ä¼šå¯¼è‡´æ›´å¤šçš„false postiveâ€”â€”å³è¿”å›ä¸ç›¸ä¼¼çš„â€œcandidate pairâ€ã€‚è¿™æ˜¯ä¿®æ”¹å‚æ•° b çš„ä¸å¯é¿å…çš„ç»“æœã€‚

TP = True positive; FP = False positive; TN = True negative; FN = False negative

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/cb70b6a2a7f54ed7b5fdeef8394a7210.png)

LSH å®¹æ˜“å—åˆ°é«˜ç»´æ•°æ®çš„å½±å“ï¼šæ›´å¤šçš„ç»´åº¦éœ€è¦æ›´é•¿çš„signatureé•¿åº¦å’Œæ›´å¤šçš„è®¡ç®—æ‰èƒ½ä¿æŒè‰¯å¥½çš„æœç´¢è´¨é‡ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå»ºè®®ä½¿ç”¨å…¶ä»–ç´¢å¼•ã€‚

### more

è¿˜æœ‰ä¸¤ç¯‡æ²¡å•ƒå®Œï¼Œå¤§æ¦‚çœ‹äº†ä¸‹è·Ÿbinary vectorå’Œæ¬§å‡ é‡Œå¾—è·ç¦»ç›¸å…³

https://towardsdatascience.com/similarity-search-part-6-random-projections-with-lsh-forest-f2e9b31dcc47

https://towardsdatascience.com/similarity-search-part-7-lsh-compositions-1b2ae8239aca



## HNSWç´¢å¼•

HNSWç®—æ³•ï¼ˆ Hierarchical navigable small worldï¼‰æ˜¯åŸºäºå¤šå›¾å±‚çš„é‚»è¿‘ç®—æ³•ã€‚HNSWç›®å‰æ˜¯æœ€æµè¡Œçš„å‘é‡ç´¢å¼•ç®—æ³•ä¹‹ä¸€ã€‚

ä»é«˜å±‚æ¬¡æ¥çœ‹ï¼ŒHNSWåŸºäº[å°ä¸–ç•Œç†è®º](https://en.wikipedia.org/wiki/Small-world_network)ã€‚å°ä¸–ç•Œç†è®ºæœ€åˆæºäºç¤¾ä¼šå¿ƒç†å­¦çš„[å…­åº¦åˆ†éš”ç†è®º](https://en.wikipedia.org/wiki/Six_degrees_of_separation)ï¼Œä»»ä½•ä¸¤ä¸ªäººä¹‹é—´ä»…ä»…é€šè¿‡äº”å±‚ç¤¾ä¼šå…³ç³»å°±èƒ½å¤Ÿè¢«ç›¸äº’è¿æ¥ï¼Œæ¢å¥è¯è¯´ï¼Œå°±æ˜¯ä»»ä½•ä¸¤ä¸ªåœ°çƒä¸Šçš„äººéƒ½å¯ä»¥é€šè¿‡æœ€å¤šå…­æ­¥ç¤¾ä¼šè”ç³»æ¥ç›¸äº’è”ç³»ä¸Šã€‚å°ä¸–ç•Œç†è®ºåæ¥è¢«å®éªŒå’Œä½¿ç”¨ç»éªŒä½è¯è€Œè¢«å¹¿æ³›æ¥å—ï¼Œå¹¶æ‰©å±•åˆ°éç¤¾ä¼šå…³ç³»ç½‘ç»œä¸­ã€‚æ³¨æ„å°ä¸–ç•Œç†è®ºæ˜¯ä¸€ç§ç°è±¡ã€‚

æ€»ä¹‹ï¼Œå°ä¸–ç•Œç†è®ºæ˜¯åœ¨è¯´æ˜â€œ*ä¸¤ä¸ªäº‹åŠ¡é—´çš„è”ç³»å®é™…ä¸Šæ˜¯å¾ˆçŸ­çš„*â€ã€‚HNSWæ‰€åšçš„äº‹æƒ…å°±æ˜¯å»ºç«‹ä¸¤ä¸ªå…ƒç´ ä¹‹é—´çš„è”ç³»ã€å‡å°‘è”ç³»æ•°ã€‚

### HNSWç´¢å¼•çš„æ„å»º

çœ‹ä¸‹HNSWè®ºæ–‡å…³äºæ„å»ºHNSWå›¾å±‚çš„ç®—æ³•[^65]ï¼š

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/00051012b0944d7aaea6406286dcae62.png)

æ„å»ºç®—æ³•ä¸­æœ‰å‡ ä¸ªè¦ç´ æ˜¯æ¯”è¾ƒé‡è¦çš„ï¼š

- Mä¸ºæ–°å¢çš„è¾¹connectionï¼Œè¡¨ç¤ºæ–°æ’å…¥çš„èŠ‚ç‚¹çš„æ–°è¾¹ä¸ªæ•°ã€‚
- Mmaxä¸ºèŠ‚ç‚¹çš„è¾¹çš„æœ€å¤§ä¸ªæ•°ã€‚å¦‚æœä¸€ç›´æ’å…¥çš„æ˜¯é‚»è¿‘èŠ‚ç‚¹ï¼Œé‚£ä¹ˆå·²æœ‰çš„é‚»è¿‘èŠ‚ç‚¹çš„è¾¹æœ‰å¯èƒ½ä¸€ç›´å¢åŠ ï¼ŒæŸ¥æ‰¾æ—¶ä¼šæµªè´¹ç®—åŠ›ã€‚å½“æ–°å¢èŠ‚ç‚¹æ—¶å‘ç°æ–°æ’å…¥è¾¹å¯¼è‡´å·²æœ‰é‚»è¿‘èŠ‚ç‚¹çš„è¾¹å¤§äºMmaxï¼Œé‚£ä¹ˆéœ€è¦åšshrink connectionã€‚
- efConstructionä¸ºé‚»è¿‘çš„èŠ‚ç‚¹é›†ã€‚



æ„å»ºå›¾ä¾‹[^66]ï¼š



![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/6d3214a05a904a959e1161954b1f4c01.png)

**HNSWæ·»åŠ nodeçš„æ­¥éª¤ï¼ˆwithout shrink connectionï¼‰**ï¼š

1. æ–°èŠ‚ç‚¹æ’å…¥æ—¶ï¼Œå…ˆåœ¨æœ€ä¸Šå±‚é€šè¿‡*efConstruction*æ‰¾åˆ°é‚»è¿‘èŠ‚ç‚¹ã€‚ä»¥æ‰¾åˆ°çš„æœ€é‚»è¿‘èŠ‚ç‚¹å½“åšentry pointè¿›å…¥åˆ°ä¸‹ä¸€å±‚ï¼Œç„¶åç»§ç»­é€šè¿‡é‚£å±‚çš„*efConstruction*æŸ¥æ‰¾é‚»è¿‘èŠ‚ç‚¹ã€‚
1. åœ¨æŸå±‚ï¼ˆå¦‚L=2)åšnodeæ’å…¥ã€‚ä»*efConstruction*ä¸­æ‰¾å‡ºMä¸ªèŠ‚ç‚¹ï¼Œå¹¶è¿æ¥æ–°èŠ‚ç‚¹ï¼Œæ­¤æ—¶æ–°å¢äº†1ä¸ªèŠ‚ç‚¹å¹¶æ·»åŠ Mæ¡è¾¹ä¸ä¹‹ç›¸è¿ã€‚
1. é‡å¤step2ï¼Œç›´åˆ°æœ€åº•å±‚layer0ã€‚



### HNSWå¯å‘å¼é‚»å±…æ„å»º

åŸºæœ¬çš„HNSWç´¢å¼•ç»“æ„æ„å»ºè¿˜å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœæœ‰ä¸¤ä¸ªç°‡ç›¸éš”æ¯”è¾ƒè¿œï¼Œé‚£ä¹ˆæ ¹æ®æœ€å…·å¤‡çš„HNSWæ„å»ºç®—æ³•ï¼Œä¸¤ä¸ªç°‡å‡ ä¹ä¸å¯èƒ½ç›¸è¿ï¼Œå› ä¸ºæ„å»ºHNSWçš„åŸºæœ¬ç®—æ³•æ˜¯åŸºäºæœ€é‚»è¿‘çš„èŠ‚ç‚¹*efConstruction*æ¥æ„å»ºçš„ã€‚

[HNSW original paper](https://arxiv.org/pdf/1603.09320)é™¤äº†æå‡ºæœ€åŸºæœ¬çš„æ„å»ºHNSWçš„ç®—æ³•ï¼Œä¹Ÿæå‡ºäº†è§£å†³å­¤ç«‹ç¾¤é›†çš„å¯å‘å¼ç®—æ³•ï¼š

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/3cb77b0aad5b4f4b82af0e659a4c4c41.png)

> Fig.2 ä¸ºä¸¤ä¸ªå­¤ç«‹çš„ç¾¤é›†é€‰æ‹©å›¾å½¢é‚»å±…çš„å¯å‘å¼æ–¹æ³•ã€‚ä¸€ä¸ªæ–°å…ƒç´ è¢«æ’å…¥åˆ°cluster 1çš„è¾¹ç•Œä¸Šã€‚è¯¥å…ƒç´ çš„æ‰€æœ‰æœ€è¿‘é‚»å±…éƒ½å±äºcluster 1ï¼Œå› æ­¤é”™è¿‡äº†ç¾¤é›†ä¹‹é—´çš„Delaunayä¸‰è§’ç½‘çš„è¾¹ç¼˜ã€‚ç„¶è€Œï¼Œå¯å‘å¼æ–¹æ³•é€‰æ‹©äº†æ¥è‡ªç¾¤é›†2çš„å…ƒç´ e2ï¼Œå› æ­¤ï¼Œå¦‚æœæ’å…¥çš„å…ƒç´ ä¸æ¥è‡ªç¾¤é›†1çš„ä»»ä½•å…¶ä»–å…ƒç´ ç›¸æ¯”æ›´é è¿‘e2ï¼Œå°±èƒ½ä¿æŒå…¨å±€è¿é€šæ€§ã€‚

**â€œå¯å‘å¼ç®—æ³•ä¸ä»…è€ƒè™‘äº†å›¾ä¸­èŠ‚ç‚¹ä¹‹é—´æœ€è¿‘çš„è·ç¦»ï¼Œè¿˜è€ƒè™‘äº†å›¾ä¸Šä¸åŒåŒºåŸŸä¹‹é—´çš„è¿é€šæ€§â€**

å¦‚ä¸‹å›¾æ·»åŠ ä¸€ä¸ªXèŠ‚ç‚¹ï¼Œè¿™é‡Œå°±åº”è¯¥å¯ç”¨å¯å‘å¼ç®—æ³•ï¼Œä¸cluster Aå»ºç«‹è¿æ¥æ€§ï¼Œè€Œä¸æ˜¯ç®€å•çš„æ·»åŠ åˆ°é‚»è¿‘èŠ‚ç‚¹ä¸Šï¼š

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/2577ce36301842d6beffc8999d190cdb.png)



### HNSWç´¢å¼•å¯»è¿¹

[HNSW original paper](https://arxiv.org/pdf/1603.09320)ä¸­æåˆ°çš„HNSWå¯»æ‰¾KNNçš„æ–¹æ³•çš„ä¸»ä½“é€»è¾‘åŒ…å«å¦‚ä¸‹2ä¸ªç®—æ³•ï¼š 

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/ba06d3bb151943cbb7b48d17b212a2f9.png)

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/bb81649a8fda432bae9d212d1f436a61.png)

- ç®—æ³•2çœ‹ä¸Šå»è¦ç¨å¾®å¤æ‚ç‚¹ï¼Œå®é™…ä¸Šé€»è¾‘å¾ˆç®€å•ï¼Œç®—æ³•2çš„åŠŸèƒ½æ˜¯åœ¨è¯¥å±‚ä¸­æ‰¾åˆ°å¯¹äºqæœ€é‚»è¿‘çš„èŠ‚ç‚¹é›†efã€‚ç®—æ³•2ç®€å•æ¥è¯´å°±æ˜¯æŠŠcandidateèŠ‚ç‚¹åŠ å…¥åˆ°efé›†å¹¶æ¯”è¾ƒè·ç¦»ï¼ŒæŠŠæœ€è¿œçš„èŠ‚ç‚¹å‰”å‡ºå»ï¼Œè¿™æ ·è¿”å›çš„Wå°±æ˜¯è¯¥å±‚å¯¹äºqçš„efã€‚

- ç®—æ³•5çš„åŠŸèƒ½æ˜¯è¿”å›qçš„Kä¸ªæœ€é‚»è¿‘èŠ‚ç‚¹ï¼Œå®ƒä¼šè°ƒç”¨ç®—æ³•2ä¸¤æ¬¡ï¼ˆæˆ–å¤šæ¬¡ï¼‰ã€‚forä¸­çš„ç¬¬ä¸€è¡Œè¾“å…¥å‚æ•°ef=1ï¼Œä¹Ÿå°±æ˜¯è¯´éæœ€åº•å±‚çš„layeréƒ½åªæ‰¾æœ€é‚»è¿‘çš„epï¼ˆentry pointï¼‰ï¼Œæœ€åº•å±‚ï¼ˆlc=0ï¼‰è¿”å›Kä¸ªæœ€é‚»è¿‘èŠ‚ç‚¹é›†Wã€‚



![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/e0cae2e33c7644fbac5de89bf31430b1.png)





### HNSWå¤æ‚åº¦

HNSWçš„å±‚æ•°ä¸ºlog(N)å‡½æ•°ã€‚

æŸ¥è¯¢å¤æ‚åº¦ï¼šåœ¨Delaunay graphä¸­å¯ä»¥ä¸¥æ ¼è¯„ä¼°å¤æ‚åº¦ï¼Œå¹³å‡å¤æ‚åº¦ä¸º O(log(N))ï¼ˆéDelaunay graphï¼Œå¦‚å­˜åœ¨å¯å‘å¼é‚»è¿‘ç®—æ³•çš„graphï¼Œè®ºæ–‡æ²¡æœ‰ç»™å‡ºå…·ä½“çš„å¤æ‚åº¦å…¬å¼ï¼‰ã€‚

æ„å»ºå¤æ‚åº¦ï¼šHNSWæ˜¯é€šè¿‡æ‰€æœ‰å…ƒç´ è¿­ä»£æ’å…¥æ„å»ºçš„ï¼Œå¹³å‡å¤æ‚åº¦ä¸ºO(Nâˆ™log(N)) ã€‚



### HNSWç´¢å¼•å‚æ•°

ä¸€èˆ¬å‘é‡æ•°æ®çš„HNSWç´¢å¼•éƒ½æœ‰å‡ ä¸ªå‚æ•°å¯ä»¥è°ƒæ•´ï¼Œè¿™äº›å‚æ•°ä¼šå½±å“ç´¢å¼•æ„å»ºé€Ÿåº¦ã€å¬å›ç‡ç­‰ã€‚ä¸åŒçš„æ•°æ®åº“å‚æ•°å¯èƒ½ç¨å¾®æœ‰å·®å¼‚ï¼Œè¿™é‡Œä»¥pgvectorçš„HNSWå‚æ•°ä¸ºä¾‹ï¼š

ç´¢å¼•æ„å»ºå‚æ•°ï¼š

â€¢ mï¼šå‘é‡çš„è¾¹çš„æœ€å¤§ä¸ªæ•°ï¼Œé»˜è®¤ä¸º16ã€‚ç›¸å½“äºè®ºæ–‡ä¸­Mmaxã€‚
â€¢ ef_constructionï¼šæ„å»ºç´¢å¼•æ—¶é‚»è¿‘åˆ—è¡¨ä¸­çš„å‘é‡ä¸ªæ•°ï¼Œé»˜è®¤64ã€‚ç›¸å½“äºè®ºæ–‡ä¸­ef_constructionã€‚

ç´¢å¼•æœç´¢å‚æ•°ï¼š

â€¢ hnsw.ef_searchå¯è°ƒæ•´æœç´¢æ—¶é‚»è¿‘åˆ—è¡¨ä¸­çš„å‘é‡ä¸ªæ•°ï¼ˆä¹Ÿç›¸å½“äºè®ºæ–‡ä¸­ef_constructionï¼‰ã€‚å¿…é¡»å¤§äºç­‰äºlimitã€‚

æ„å»ºç´¢å¼•æ—¶ï¼Œè°ƒæ•´ef_constructionå¯¹åˆ›å»ºæ—¶é—´å’Œå¬å›ç‡çš„å½±å“[^19]ï¼š

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/90feb5f20dba44ffb5a655cfc7e4134b.png)



æé«˜ef_constructionè¿™ä¸ªå‚æ•°ä¼šæé«˜å¬å›ç‡ï¼Œå»¶é•¿åˆ›å»ºç´¢å¼•æ—¶é—´ã€‚ef_construction=256ä»¥åï¼Œç´¢å¼•æ„å»ºæ—¶é—´æ˜æ˜¾å¢åŠ ï¼Œä½†å¬å›ç‡æå‡ä¸æ˜æ˜¾ã€‚

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/34c850bb9bc84b35b11ecba8ed2a5565.png)

æé«˜mï¼ŒåŒæ ·ä¼šæé«˜å¬å›ç‡ï¼Œå»¶é•¿åˆ›å»ºç´¢å¼•æ—¶é—´ã€‚m=36ä»¥åï¼Œç´¢å¼•æ„å»ºæ—¶é—´æ˜æ˜¾å¢åŠ ï¼Œä½†å¬å›ç‡æå‡ä¸æ˜æ˜¾ã€‚

åŒæ ·çš„ï¼Œæé«˜hnsw.ef_searchä¼šæå‡å¬å›ç‡ï¼Œé™ä½æ€§èƒ½ã€‚



## IVFFlatç´¢å¼•

IVFFlatç´¢å¼•å…¨ç§°ä¸ºæ‰å¹³å‹ç¼©çš„å€’æ’ç´¢å¼•ï¼ˆ Inverted File with Flat Compressionï¼‰ï¼ˆè·Ÿinvertæœ‰å•¥å…³ç³»ï¼Ÿåˆ†ä¸äº†ç±»çš„ç´¢å¼•éƒ½å«å€’æ’ï¼Ÿï¼‰ã€‚IVFFlatç´¢å¼•çš„æ ¸å¿ƒç†å¿µåŸºäºvoronoi diagramï¼š

> Voronoiå›¾çš„ä¸»è¦ç‰¹æ€§æ˜¯ï¼š*ä»ä¸€ä¸ªè´¨å¿ƒåˆ°å…¶åŒºåŸŸå†…ä»»ä½•ç‚¹çš„è·ç¦»éƒ½å°äºè¯¥ç‚¹åˆ°å¦ä¸€ä¸ªè´¨å¿ƒçš„è·ç¦»*ã€‚

è¿™ä¸ªç‰¹æ€§ç”¨å…¬å¼è¡¨è¾¾ï¼š
$$
R_k=\{x \in X \,|\,d(x,P_k) \le d(x,P_j) \; \mathrm{for \,all }\,j \neq k\}
$$
Rkæ˜¯è´¨å¿ƒï¼Œd(x,Pk)æ˜¯è´¨å¿ƒåˆ°å…¶åŒºåŸŸå†…ä»»ä½•ç‚¹çš„è·ç¦»ï¼Œd(x,Pj)æ˜¯å…¶ä»–è´¨å¿ƒåˆ°è¯¥åŒºåŸŸä»»ä½•ç‚¹çš„è·ç¦»ã€‚



åˆ©ç”¨è¿™ä¸ªæ¦‚å¿µå¯ä»¥é€šè¿‡è®¾ç½®è´¨å¿ƒï¼ŒæŠŠä¼—å¤šå‘é‡è¿›è¡ŒåŒºåŸŸåˆ’åˆ†ï¼Œç„¶ååˆ©ç”¨voronioå›¾çš„ç‰¹æ€§ï¼Œç²—ç•¥åœ°æ‰¾åˆ°é‚»è¿‘ç‚¹ã€‚



### IVFFlatç´¢å¼•çš„æ„å»º

æˆ‘ä»¬å°†é«˜ç»´ç©ºé—´ä¸‹é™åˆ°2ç»´ä»¥ä¾¿ç†è§£IVFFlatç´¢å¼•æ„å»º[^67]ã€‚

ä¾‹å¦‚ä»¥ä¸‹ä¸€å †xè¡¨ç¤ºç‚¹ï¼ˆæˆ–è€…å«å‘é‡ï¼‰ï¼Œå‡è®¾æˆ‘ä»¬æœ‰ä¸‰ä¸ªè´¨å¿ƒ

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/9bbc3095f7934567a0a515ef71c7c1c0.png)

ä¸‰ä¸ªè´¨å¿ƒåˆ’åˆ†å‡º3ä¸ªVoronoi cellï¼Œæ‰€æœ‰ç‚¹éƒ½åˆ†é…åˆ°å„è‡ªçš„Voronoi cellä¸­

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/a255c3e00b48407e946f0df49b62c8ff.png)



### IVFFlatç´¢å¼•å¯»è¿¹

æ­¤æ—¶æœ‰ä¸€ä¸ªqueryèŠ‚ç‚¹ï¼Œç„¶åè®¡ç®—å®ƒåˆ°æ‰€æœ‰è´¨å¿ƒçš„è·ç¦»ï¼Œç„¶åæ‰¾åˆ°æœ€è¿‘çš„é‚£ä¸ªè´¨å¿ƒï¼Œè¿™ä¸ªè´¨å¿ƒæ‰€åœ¨çš„cellå°±æ˜¯æ¥ä¸‹æ¥è¦å¯»æ‰¾çš„åŒºåŸŸã€‚æœ€ååœ¨è¿™ä¸ªåŒºåŸŸèŒƒå›´å†…ï¼Œæ‰¾åˆ°é‚»è¿‘çš„èŠ‚ç‚¹[^68]ï¼š

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/0f28407a0dea42df84f1b03e3f1142a6.png)





è¾¹ç•Œé—®é¢˜ï¼š

ä¸Šé¢çš„æŸ¥è¯¢è·¯å¾„å­˜åœ¨è¾¹ç•Œé—®é¢˜ã€‚å½“queryé è¿‘åŒºåŸŸè¾¹ç•Œçš„æ—¶å€™ï¼Œå¦‚æœå­˜åœ¨æœ€è¿‘çš„èŠ‚ç‚¹åœ¨å…¶ä»–åŒºåŸŸä¸­ï¼Œé‚£ä¹ˆé â€œä»…æœç´¢åŒºåŸŸå†…é‚»è¿‘èŠ‚ç‚¹â€çš„ç®—æ³•ï¼Œæ˜¯ä¸ä¼šæ‰¾åˆ°è¿™ä¸ªæœ€é‚»è¿‘èŠ‚ç‚¹çš„ã€‚

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/450eba0af56c43e8add41fdefa33a7cf.png)

è¾¹ç•Œé—®é¢˜æœ¬è´¨æ˜¯å› ä¸ºï¼š

**voronioå›¾åªèƒ½ä¿è¯æŸèŠ‚ç‚¹åˆ°å…¶åŒºåŸŸè´¨å¿ƒçš„è·ç¦»å°äºåˆ°å…¶ä»–è´¨å¿ƒçš„è·ç¦»ï¼Œä½†ä¸ä¿è¯æŸèŠ‚ç‚¹åˆ°åŒºåŸŸå†…å…¶ä»–èŠ‚ç‚¹çš„è·ç¦»å°äºåˆ°å…¶ä»–åŒºåŸŸèŠ‚ç‚¹çš„è·ç¦»**ã€‚

è¿™ä¸ªé—®é¢˜å¯ä»¥é€šè¿‡è®¾ç½®æœç´¢çš„åŒºåŸŸæ•°é‡æ¥ç¼“è§£ï¼Œä¾‹å¦‚æŠŠæœç´¢çš„åŒºåŸŸæ•°é‡ä»1å¢åŠ åˆ°3ï¼š

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/baa4edef667c4cbca33f5300c07d712f.png)

å¢åŠ æœç´¢åŒºåŸŸæ•°é‡ä¸€èˆ¬éƒ½ä»¥å‚æ•°å½¢å¼è®¾ç½®åœ¨æ•°æ®åº“ä¸­ï¼Œä¾‹å¦‚pgvectorä¸­çš„ivfflat.probesã€‚



**IVFFlatå¯»è¿¹æ¦‚è¿°**ï¼š

1. è®¡ç®—queryèŠ‚ç‚¹åˆ°æ‰€æœ‰å…¶ä»–è´¨å¿ƒçš„è·ç¦»ï¼Œæ‰¾åˆ°æœ€è¿‘çš„é‚£ä¸ª
2. æ ¹æ®æŸ¥è¯¢cellsä¸ªæ•°çš„å…¥å‚ï¼ˆä¾‹å¦‚probesï¼‰ï¼Œåœ¨top probesä¸ªcellsä¸­å¯»æ‰¾é‚»è¿‘ç‚¹



### IVFFlatç´¢å¼•å‚æ•°

åŒæ ·çš„ï¼Œæ”¯æŒIVFFlatç´¢å¼•çš„å‘é‡æ•°æ®åº“ä¸­ï¼Œä¸€èˆ¬è‡³å°‘éƒ½æœ‰listå’Œprobeä¸¤ä¸ªå‚æ•°ã€‚è¿™äº›å‚æ•°ä¼šå½±å“ç´¢å¼•æœç´¢æ€§èƒ½ã€å¬å›ç‡ã€‚è¿™é‡Œä»¥Faissçš„å‚æ•°ä¸ºä¾‹[^67]ã€‚

- nlistï¼šæ„å»ºåŒºåŸŸçš„ä¸ªæ•°ã€‚å¢å¤§nlistä¼šæé«˜æœç´¢é‚»è¿‘è´¨å¿ƒçš„æ—¶é—´ï¼Œä½†ä¼šå‡å°‘åŒºåŸŸå†…æœç´¢èŠ‚ç‚¹çš„æ—¶é—´

- nprobeï¼šæœç´¢åŒºåŸŸçš„ä¸ªæ•°ã€‚å¢å¤§nprobeå¢å¤§æœç´¢åŒºåŸŸä¸ªæ•°ï¼Œå¾ˆæ˜æ˜¾ä¼šé™ä½æœç´¢æ€§èƒ½ï¼Œæå‡å¬å›ç‡



ç†è®ºä¸Šæ¥è¯´ï¼Œå¯¹äºnlistï¼Œæœ€å¥½é’ˆå¯¹æ€§çš„å¯¹å‘é‡æ•°æ®çš„ç»“æ„ã€æ•°æ®åº“ç±»å‹è¿›è¡Œæµ‹è¯•ï¼Œä¸ä¸€å®šæé«˜nlistæ€»æ˜¯ä¼šé™ä½å“åº”æ—¶é—´ã€‚å¯¹äºnprobeï¼Œå¢å¤§nprobeä¸€å®šä¼šé™ä½æœç´¢æ€§èƒ½ã€æå‡å¬å›ç‡ï¼Œä½†æ˜¯nprobeå¤ªå¤§æ²¡æœ‰æ„ä¹‰ï¼Œä¸ç¬¦åˆANNçš„åˆè¡·ã€‚

ä»¥ä¸‹æºè‡ªPineconeå¯¹Faiss IVVFlatç´¢å¼•çš„æ€§èƒ½æµ‹è¯•ï¼š



![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/696c918a3a114cf9aa0e5fcc7f8d0f75.png)



## PQä¹˜ç§¯é‡åŒ–

100wä¸ªå¯†é›†å‘é‡å¯èƒ½éœ€è¦ä¸ŠGçš„å†…å­˜ï¼Œè€ŒçœŸå®ä¸–ç•Œä¸­çš„å‘é‡è¿œä¸æ­¢è¿™ä¸ªæ•°ã€‚å¦‚æœä¸åŠ ä»¥ç®¡ç†ï¼Œç›¸ä¼¼æ€§å‘é‡æœç´¢å¯èƒ½éœ€è¦å¤§é‡å†…å­˜ï¼Œç„¶è€Œå†…å­˜RAMæ˜¯æœ‰é™çš„ã€‚å‘é‡çš„å¤§å°éšå‘é‡çš„ç»´åº¦ã€å‘é‡ä¸ªæ•°è€Œå¢åŠ ã€‚

ä¹˜ç§¯é‡åŒ–ï¼ˆProduct Quantizationï¼‰æ—¨åœ¨å‡å°‘å†…å­˜ä½¿ç”¨ï¼Œè¿˜å¯ä»¥æå‡æŸ¥è¯¢é€Ÿåº¦ï¼ˆå› ä¸ºè®¡ç®—é‡å‡å°‘äº†ï¼‰ã€‚PQæ˜¯ä¸€ç§æœ‰æŸå‹ç¼©æ–¹æ³•ï¼Œè¿™ä¼šå¯¼è‡´å‘é‡æ£€ç´¢çš„å‡†ç¡®æ€§é™ä½ï¼Œä¸è¿‡è¿™åœ¨ANNéœ€æ±‚ä¸­æ˜¯è¡Œçš„ã€‚

PQçš„ç®—æ³•é€»è¾‘ç¨å¾®æ¯”å…¶ä»–ç®—æ³•å¤æ‚ä¸€äº›ï¼Œå¼ºçƒˆæ¨èè¿™ç¯‡æ–‡ç« [Similarity Search, Part 2: Product Quantization](https://towardsdatascience.com/similarity-search-product-quantization-b2a1a6397701)[^50]

 ### PQçš„æ„å»º

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/1d77a56ec06845dab7e43db8e6ae8839.png)

æ­¥éª¤æè¿°ï¼š

1. subvectors--å°†åŸå§‹çš„é«˜ç»´å‘é‡åˆ‡åˆ†æˆnä¸ªä½ç»´å­å‘é‡
2. codebook--å°†nä¸ª*å„è‡ª*æ‰€æœ‰çš„å­å‘é‡é€šè¿‡k-meansç®—æ³•è®¡ç®—å„è‡ªçš„voronoiå›¾ï¼ˆæˆ–è€…å…¶ä»–ç®—æ³•ï¼‰ï¼Œè®¡ç®—å‡ºæ¥æœ‰nä¸ªä¸åŒçš„voronoiå›¾ï¼Œè¿™äº›voronoiå›¾å°±æ˜¯codebookï¼ˆè¿™é‡Œå‡è®¾æ¯ä¸ªvoronoiå›¾éƒ½æœ‰kä¸ªè´¨å¿ƒï¼‰
3. clustering--æŠŠnä¸ªå­å‘é‡æ”¾è¿›å„è‡ªå·²èšç±»å®Œæˆçš„voronoiå›¾ä¸­è®¡ç®—å‡ºæœ€è¿‘è´¨å¿ƒ
4. quantized vectors--å°†è¿™nä¸ªæœ€è¿‘è´¨å¿ƒå½“åšæ–°çš„å‘é‡-é‡åŒ–åå‘é‡
5. reproduction values--ä»¥nä¸ªå­ç©ºé—´çš„å„è‡ª*æœ€è¿‘è´¨å¿ƒçš„ç¼–å·*ä¸ºæ–°å€¼ï¼Œåˆèµ·æ¥çš„æ–°å¢ç§°ä¸ºPQ code



å…¶ä¸­5.reproduction valuesè¯¦ç»†æè¿°ï¼š

æ ¹æ®nä¸ªå­å‘é‡å’Œæ¯ä¸ªå­ç©ºé—´çš„ä¸­çš„kä¸ªè´¨å¿ƒï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸€ä¸ªn*kçš„è´¨å¿ƒçŸ©é˜µã€‚å–æ¯ä¸ªå­å‘é‡çš„æœ€è¿‘è´¨å¿ƒçš„ç¼–å·ï¼Œå°±æ˜¯PQ codeã€‚

ï¼ˆbtwï¼šå¦‚æœä¸¥è°¨ä¸€ç‚¹ï¼Œä¸‹å›¾ä¸­æ‰€æœ‰å…ƒç´ çš„ä¸‹è§’ç¼–å·åº”è¯¥éƒ½æ˜¯ä»1å¼€å§‹ï¼Œè€Œä¸æ˜¯0ï¼‰

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/580636211f084a69b2faf896d558af0f.png)



æ–°çš„PQ codeç›¸å½“äºåŸå‘é‡å¤±çœŸå‹ç¼©åçš„æ–°å‘é‡ï¼ˆreproduction valueï¼‰ï¼Œæ–°çš„è·ç¦»è®¡ç®—å¯ä»¥ç›´æ¥è®¡ç®—PQ codeçš„L2è·ç¦»ã€‚



### PQçš„æ£€ç´¢

åŸºäºPQ original paper[^51]ï¼ŒPQæ£€ç´¢æ–¹å¼æœ‰ä¸¤ç§ï¼š

- å¯¹ç§°æ–¹å¼ï¼šå‘é‡xï¼Œå‘é‡yä¹‹é—´çš„è·ç¦»ï¼Œè¿‘ä¼¼é€šè¿‡ä»–ä¿©çš„è´¨å¿ƒq(x),q(y)çš„è·ç¦»æ¥ä»£æ›¿ã€‚æ¢è¨€ä¹‹ï¼Œä¿©ä¸ªå‘é‡çš„è·ç¦»å¯é€šè¿‡ä¸¤ä¸ªå‘é‡çš„PQ codeè·ç¦»æ¥ä»£æ›¿
- éå¯¹ç§°æ–¹å¼ï¼šå‘é‡xï¼Œå‘é‡yä¹‹é—´çš„è·ç¦»ï¼Œè¿‘ä¼¼é€šè¿‡xåˆ°è´¨å¿ƒq(y)çš„è·ç¦»æ¥æ›¿ä»£ã€‚æ¢è¨€ä¹‹ï¼Œä¿©ä¸ªå‘é‡çš„è·ç¦»å¯é€šè¿‡æŸ¥è¯¢å‘é‡åŸå€¼å’Œå¦ä¸€ä¸ªå‘é‡çš„PQ codeæ¥è®¡ç®—



![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/6ebf6e27c3b644e48ee83db5bae5c3c5.png)

å¾ˆæ˜æ˜¾ä¸¤ä¸ªæ¨¡å¼è®¡ç®—çš„è·ç¦»å‡†ç¡®åº¦æ˜¯ä¸ä¸€æ ·çš„ï¼š

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/e9136ffea3be4f3da5dfb6fa79dbf311.png)

ä¸Šå›¾è¡¨ç¤º8ä¸ªå­ç©ºé—´ï¼Œ256ä¸ªè´¨å¿ƒï¼Œåœ¨ä¸åŒæ¨¡å¼ä¸‹è®¡ç®—ä¸¤ä¸ªå‘é‡çš„è·ç¦»å‡†ç¡®åº¦ã€‚å¯ä»¥çœ‹å‡ºéå¯¹ç§°æ¨¡å¼æ¯”å¯¹ç§°æ¨¡å¼çš„å‡†ç¡®åº¦è¦é«˜ã€‚

åœ¨å¯¹æ¯”ä¸¤ä¸ªå‘é‡è·ç¦»çš„æ—¶å€™ï¼Œå¯¹ç§°å’Œéå¯¹ç§°æ¨¡å¼çš„è·ç¦»è®¡ç®—æ¨¡å‹æ˜¯æ¯”è¾ƒæœ‰ç”¨çš„ã€‚ä½†åœ¨æŸ¥æ‰¾PQè¿‘ä¼¼å‘é‡çš„æ—¶å€™åœºæ™¯ä¸­ï¼Œç¨å¾®æœ‰äº›å·®åˆ«ï¼Œç‰¹åˆ«æ˜¯å¯¹ç§°æ¨¡å¼è®¡ç®—å¤±çœŸä¼šéå¸¸ä¸¥é‡ï¼š

- å¯¹ç§°æ–¹å¼çš„æŸ¥è¯¢é€Ÿåº¦æ˜¯éå¸¸å¿«çš„ï¼Œå› ä¸ºcode tableå·²ç»é€šè¿‡PQæ„å»ºè¿‡ç¨‹è®¡ç®—å¹¶ä¿ç•™äº†ï¼Œåªéœ€è¦å…ˆé€šè¿‡code tableæŠŠæŸ¥è¯¢å‘é‡xçš„PQ codeç®—å‡ºæ¥ï¼ˆè®¡ç®—é‡æå°ï¼‰ï¼Œç„¶åé€šè¿‡PQ codeåå‘è·å¾—çš„code tableä¸­å¯¹åº”çš„é‚£äº›å­code tableï¼Œè¿™ä¸ªå­code tableé‡Œçš„å‘é‡éƒ½æ˜¯ä¸å…¶è·ç¦»ç›¸ç­‰çš„è¿‘ä¼¼å‘é‡ã€‚è¿™ç§æ–¹å¼è®¡ç®—é‡æå°‘ï¼Œç›´æ¥æŸ¥è¡¨å³å¯ã€‚

- å¯¹ç§°æ–¹å¼çš„å¤±çœŸæƒ…å†µç›¸å¯¹æ¯”è¾ƒä¸¥é‡ï¼ˆä¸Šé¢2ä¸ªå›¾è¿˜ä¸æ˜¯å¾ˆå¥½ï¼ŒæŠŠå®ƒæƒ³è±¡æˆä¸€ä¸ªcellä¸­åŒ…å«å¤šä¸ªå‘é‡çš„voronoiå›¾ï¼Œå°±çŸ¥é“å¯¹ç§°æ–¹å¼å¤±çœŸæœ‰å¤šä¸¥é‡äº†ï¼‰ï¼Œéå¯¹ç§°æ–¹å¼å¯ä»¥*ç¨å¾®*ç¼“è§£è¿™ä¸ªé—®é¢˜ã€‚éå¯¹ç§°æ–¹å¼å…ˆè®¡ç®—å‘é‡xçš„PQ codeï¼Œç„¶ååŒæ ·é€šè¿‡PQ codeåå‘è·å¾—çš„code tableä¸­å¯¹åº”çš„é‚£äº›å­code tableï¼Œç„¶åé€šè¿‡å‘é‡xä¸è¿™ä¸ªå­code tableä¸­çš„å‘é‡è¿›è¡Œè·ç¦»è®¡ç®—ï¼Œå¾—åˆ°KNNã€‚å®ƒçš„è®¡ç®—é‡ä¸ºn*kmï¼ˆn=å­ç©ºé—´æ•°ï¼Œkmâ‰ˆæ‰€æœ‰å‘é‡æ•°/è´¨å¿ƒæ•°ï¼‰ã€‚

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/657e111f5e8a41a08ea6149afaf066ad.png)

éå¯¹ç§°çš„éœ€è¦é€šè¿‡PQ codeæ‰¾åˆ°è´¨å¿ƒï¼Œåœ¨è´¨å¿ƒæ‰€åœ¨çš„å­ç©ºé—´ä¸­æ‰¾KNNï¼ŒæŸ¥è¯¢å‘é‡xä¸å·²å­˜åœ¨å‘é‡yçš„è·ç¦»é€šè¿‡å‘é‡xä¸yçš„è´¨å¿ƒæ¥è¿‘ä¼¼æ›¿ä»£ã€‚

PQéå¯¹ç§°æ–¹å¼æ£€ç´¢[^50]ï¼š



![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/66282bc737594a3ea58fb6779b52e7e6.png)



![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/2e6392bd7c254702b665ef9ad02e3a4b.png)

PQéå¯¹ç§°æ–¹å¼æ£€ç´¢æ­¥éª¤ï¼š

1. æŸ¥è¯¢å‘é‡åˆ†æˆä¸ºå¤šä¸ªå­å‘é‡
2. è®¡ç®—å­å‘é‡å’Œè´¨å¿ƒçŸ©é˜µçš„è·ç¦»
3. å–å­ç©ºé—´ä¸­æœ€è¿‘çš„è´¨å¿ƒï¼Œå½“åšæŸ¥è¯¢å‘é‡çš„PQ code
4. é€šè¿‡æŸ¥è¯¢å‘é‡å’ŒPQ codeå¯¹åº”çš„è´¨å¿ƒæ¥è®¡ç®—è¿‘ä¼¼è·ç¦»ï¼Œè·ç¦»å¯åœ¨å„è‡ªå­ç©ºé—´å•ç‹¬è®¡ç®—ç„¶åç´¯åŠ 



æˆ‘ä»¬å‰é¢æåˆ°éå¯¹ç§°ç›¸å¯¹å¯¹ç§°çš„è¿‘ä¼¼è·ç¦»è®¡ç®—è¦ç¨å¾®å¥½äº›ï¼Œåœ¨æŸäº›åœºæ™¯ä¸‹éå¯¹ç§°çš„è·ç¦»è·Ÿå®é™…è·ç¦»ä¹Ÿå¯èƒ½äº§ç”Ÿè¾ƒå¤§çš„å·®è·ï¼š

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/56d63fdb1fb44fff835263c64a8f9824.png)

ä»¥ä¸Šå›¾æ¯”è¾ƒå¥½ç†è§£ã€‚åœ¨åŒä¸€cellä¸­ï¼Œæœ€è¿œç«¯çš„vectorè·Ÿæœ€é è¿‘è´¨å¿ƒçš„vectorè·Ÿè´¨å¿ƒçš„è·ç¦»å¯èƒ½å·®åˆ«è¾ƒå¤§ï¼Œåªè®¡ç®—åˆ°è´¨å¿ƒè·ç¦»çš„partial distanceæ— æ³•ä½“ç°è¿™ç§å·®åˆ«ã€‚



### PQçš„å‚æ•°åŠå…¶å½±å“

PQè‡³å°‘æœ‰ä¸¤ä¸ªå‚æ•°å¯¹æ€§èƒ½å’Œå†…å­˜å½±å“æ˜¯æ¯”è¾ƒå¤§çš„ï¼Œåˆ†åˆ«æ˜¯å­ç©ºé—´æ•°mï¼Œå­ç©ºé—´çš„è´¨å¿ƒæ•°kã€‚

å¬å›ç‡ï¼š

> The product quantizer is parametrized by the number of subvectors m and the number of quantizers per subvector k âˆ— , producing a code of length m Ã— log2 k

å­ç©ºé—´æœ‰mä¸ªï¼Œæ¯ä¸ªå­ç©ºé—´çš„è´¨å¿ƒæ•°æ˜¯k^* ä¸ªï¼Œäº§ç”Ÿä¸€ä¸ªPQ codeçš„é•¿åº¦ï¼ˆbitså•ä½ï¼‰ä¸º[^51]ï¼š
$$
code \; length \, (bits)=m \cdot \log_2 k^*
$$


![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/e89014ce0ea548619c928b2d81a3037f.png)

å­ç©ºé—´mè¶Šå¤šï¼Œå¬å›ç‡è¶Šé«˜ï¼›PQ codeè¶Šé•¿ï¼Œå¬å›ç‡ä¹Ÿè¶Šé«˜ã€‚PQ codeè¶Šé•¿å…¶å®å°±æ˜¯è´¨å¿ƒæ•°è¶Šå¤šã€‚æ³¨æ„è¿™é‡Œçš„å…·ä½“å€¼æ˜¯åŸºäºè®ºæ–‡çš„æ•°æ®é›†çš„ã€‚

å†…å­˜å’Œå¤æ‚åº¦ï¼š

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/b53bea324ad5414ca08b2a9dfd0cdf7a.png)

kä»£è¡¨èšç±»è´¨å¿ƒæ•°ï¼ŒDä»£è¡¨ç»´åº¦ï¼Œmä»£è¡¨å­ç©ºé—´æ•°ã€‚k\*ä»£è¡¨å­ç©ºé—´ä¸­çš„è´¨å¿ƒï¼ŒD\*ä»£è¡¨å­ç©ºé—´ä¸­çš„ç»´åº¦ã€‚

ä¾‹å¦‚k=2048ï¼ŒD=128ï¼Œm=8ï¼Œå¤æ‚åº¦å¦‚ä¸‹[^52]ï¼š

| Operation |            Memory and complexity             |
| :-------- | :------------------------------------------: |
| k-means   |            kD = 2048Ã—128 = 262144            |
| PQ        | mk*D* = (k^(1/m))Ã—D = (2048^(1/8))Ã—128 = 332 |

å¯ä»¥çœ‹åˆ°PQåœ¨æœç´¢æ—¶å¤æ‚åº¦æ˜æ˜¾çš„ä¸‹é™ã€‚

##  DiskAnn&Vamana

[DiskAnn original paper](https://suhasjs.github.io/files/diskann_neurips19.pdf) çš„Abstract[^56]:

> Current state-of-the-art approximate nearest neighbor search (ANNS) algorithms generate indices that must be stored in main memory for fast high-recall search. This makes them expensive and limits the size of the dataset. We present a new graph-based indexing and search system called DiskANN that can index, store, and search a billion point database on a single workstation with just 64GB RAM and an inexpensive solid-state drive (SSD).



å½“å‰ï¼ˆè®ºæ–‡å‘å¸ƒäº2019å¹´ï¼‰çš„ANNç®—æ³•ä¸ºäº†é«˜å¬å›ç‡å’Œæ€§èƒ½éƒ½ä¾èµ–RAMã€‚è¿™ç§æ–¹å¼ä¸ä»…æ˜‚è´µè€Œä¸”é™åˆ¶äº†æ•°æ®é›†çš„å¤§å°ã€‚DiskANNåªéœ€è¦64GB RAMå’Œä¸ç®—è´µçš„SSDã€‚

### vamanaçš„æ„å»º

Vamana è¿­ä»£æ„å»ºä¸€ä¸ªæœ‰å‘å›¾ï¼Œé¦–å…ˆä»ä¸€ä¸ªéšæœºå›¾å¼€å§‹ï¼Œå…¶ä¸­æ¯ä¸ªèŠ‚ç‚¹ä»£è¡¨å‘é‡ç©ºé—´ä¸­çš„ä¸€ä¸ªæ•°æ®ç‚¹ã€‚èµ·åˆï¼Œå›¾æ˜¯é«˜åº¦è¿æ¥çš„ï¼Œæ‰€æœ‰èŠ‚ç‚¹éƒ½å½¼æ­¤ç›¸è¿ã€‚ç„¶åä½¿ç”¨ä¸€ä¸ªç›®æ ‡å‡½æ•°å¯¹å›¾è¿›è¡Œä¼˜åŒ–ï¼Œè¯¥ç›®æ ‡å‡½æ•°æ—¨åœ¨æœ€å¤§åŒ–æœ€æ¥è¿‘èŠ‚ç‚¹ä¹‹é—´çš„è¿æ¥æ€§ã€‚è¿™é€šè¿‡ä¿®å‰ªå¤§å¤šæ•°éšæœºçŸ­ç¨‹è¾¹ï¼ŒåŒæ—¶æ·»åŠ æŸäº›é•¿ç¨‹è¾¹æ¥å®ç°ï¼Œè¿™äº›é•¿ç¨‹è¾¹è¿æ¥ç›¸è·è¾ƒè¿œçš„èŠ‚ç‚¹ï¼ˆä»¥åŠ é€Ÿå›¾ä¸­çš„éå†ï¼‰[^56]

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/80a0a663dab34182b0953c48b8a720e5.png)

å›¾ä¸­æœ‰200ä¸ªäºŒç»´ç‚¹å¹¶è¿›è¡Œäº†ä¸¤æ¬¡è¿­ä»£ã€‚ç¬¬ä¸€æ¬¡è¿­ä»£æå¤§çš„ä¿®å‰ªäº†è¾¹ï¼Œä½†ä¹ŸæŠŠå‡å°‘è·¯å¾„é•¿åº¦çš„é•¿è¾¹ä¿®å‰ªäº†ï¼›å½“è°ƒå¤§é˜¿å°”æ³•æ”¾å¼€ä¿®å‰ªæ¡ä»¶æ—¶ï¼Œé•¿è¾¹ä¼šè¢«å¢åŠ å›æ¥[^57]ã€‚å…·ä½“ç®—æ³•å‚è€ƒè®ºæ–‡äº†ï¼Œå¤§è‡´æ˜¯è¿™ä¸ªæ„æ€ã€‚

### DiskAnnçš„ç®—æ³•

è®ºæ–‡çš„The DiskANN Index Design:

> The high-level idea is simple: run Vamana on a dataset P and store the resulting graph on an SSD. At search time, whenever Algorithm 1 requires the out-neighbors of a point p, we simply fetch this information from the SSD. However, note that just storing the vector data for a billion points in 100 dimensions would far exceed the RAM on a workstation! This raises two questions: how do we build a graph over a billion points, and how do we do distance comparisons between the query point and points in our candidate list at search time in Algorithm 1, if we cannot even store the vector data?

åœ¨å‘é‡é›†åˆä¸Šè¿è¡Œvamanaå¹¶å­˜å‚¨åœ¨SSDä¸Šã€‚åœ¨æ•°æ®é›†éå¸¸å¤§æ—¶ï¼Œéœ€è¦é¢ä¸´ä¸¤ä¸ªé—®é¢˜ï¼š

1. *å¦‚ä½•åœ¨æœ‰é™çš„å†…å­˜èµ„æºä¸‹ç´¢å¼•å¦‚æ­¤å¤§è§„æ¨¡çš„æ•°æ®é›†ï¼Ÿ*

**k-meanså’Œvamanaå åŠ ç®—æ³•**ï¼šé¦–å…ˆï¼Œä½¿ç”¨ k-means å°†æ•°æ®åˆ†æˆ k ä¸ªç°‡ï¼Œç„¶åå°†æ¯ä¸ªç‚¹åˆ†é…åˆ°æœ€è¿‘çš„ i ä¸ªç°‡ã€‚é€šå¸¸ï¼Œi çš„æ•°å€¼ä¸º 2 å°±è¶³å¤Ÿäº†ã€‚ä¸ºæ¯ä¸ªç°‡æ„å»ºåŸºäºå†…å­˜çš„ Vamana ç´¢å¼•ï¼Œæœ€åå°† k ä¸ª Vamana ç´¢å¼•åˆå¹¶ä¸ºä¸€ä¸ª

2. *å¦‚æœåŸå§‹æ•°æ®ä¸èƒ½åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œæœç´¢æ—¶å¦‚ä½•è®¡ç®—è·ç¦»ï¼Ÿ*

ä½¿ç”¨å‹ç¼©å‘é‡ï¼ˆä¾‹å¦‚PQï¼‰å¹¶å°†å‹ç¼©å‘é‡å­˜å‚¨åœ¨ä¸»å­˜ä¸­ã€‚



å¦‚æœå°†ç´¢å¼•æ•°æ®å­˜å‚¨åœ¨ SSD ä¸Šï¼Œå¿…é¡»å°½é‡å‡å°‘ç£ç›˜è®¿é—®æ¬¡æ•°å’Œç£ç›˜è¯»å†™è¯·æ±‚ï¼Œä»¥ç¡®ä¿æœç´¢å»¶è¿Ÿè¾ƒä½ï¼›åŒæ—¶å¤±çœŸçš„å‹ç¼©ä¼šé™ä½å¬å›ç‡ã€‚å› æ­¤ï¼ŒDiskANNè®ºæ–‡æå‡ºäº†ä¸‰ä¸ªä¼˜åŒ–ç­–ç•¥ï¼š

1. **Beam Search**ï¼šç®€å•æ¥è¯´ï¼Œå°±æ˜¯é¢„åŠ è½½é‚»å±…ä¿¡æ¯ã€‚åœ¨æœç´¢ç‚¹ p æ—¶ï¼Œå¦‚æœ p çš„é‚»å±…ç‚¹ä¸åœ¨å†…å­˜ä¸­ï¼Œåˆ™éœ€è¦ä»ç£ç›˜åŠ è½½ã€‚ç”±äºå°‘é‡ SSD éšæœºè®¿é—®æ“ä½œæ‰€éœ€çš„æ—¶é—´ä¸ä¸€æ¬¡ SSD å•æ‰‡åŒºè®¿é—®æ“ä½œæ‰€éœ€çš„æ—¶é—´å¤§è‡´ç›¸åŒï¼Œå¯ä»¥ä¸€æ¬¡æ€§åŠ è½½ W ä¸ªæœªè®¿é—®ç‚¹çš„é‚»å±…ä¿¡æ¯ã€‚W çš„è®¾ç½®ä¸èƒ½å¤ªå¤§ä¹Ÿä¸èƒ½å¤ªå°ã€‚W è®¾ç½®è¿‡å¤§ä¼šæµªè´¹è®¡ç®—èµ„æºå’Œ SSD å¸¦å®½ï¼Œè€Œè®¾ç½®è¿‡å°åˆ™ä¼šå¢åŠ æœç´¢å»¶è¿Ÿã€‚
2. **Caching Frequently Visited Vertices**ï¼šæ—¨åœ¨å‡å°‘ç£ç›˜è®¿é—®æ¬¡æ•°ã€‚åœ¨å†…å­˜ä¸­ç¼“å­˜ä»èµ·å§‹ç‚¹å‡ºå‘ C ä¸ªè·³ç‚¹èŒƒå›´å†…çš„æ‰€æœ‰ç‚¹ã€‚C çš„å€¼æœ€å¥½è®¾ç½®åœ¨ 3 åˆ° 4 ä¹‹é—´ã€‚

3. **Implicit Re-Ranking Using Full-Precision Vectors**ï¼šå› ä¸ºPQæ˜¯å¤±çœŸå‹ç¼©ï¼ŒåŸºäºPQçš„è·ç¦»ç®—æ³•åªæ˜¯é‚»è¿‘å®é™…è·ç¦»ã€‚ä¸ºäº†æ¶ˆé™¤è¿™ä¸ªå·®å¼‚ï¼Œæˆ‘ä»¬å­˜å‚¨æ¯ä¸ªç‚¹åˆ°å…¶é‚»è¿‘çš„æ‰€æœ‰è·ç¦»ï¼Œè¿™ä¸ªå°±æ˜¯full-precisionã€‚è‡³äºå®ç°åŸç†ï¼Œç®€å•æ¥è¯´ï¼Œä¹Ÿæ˜¯åˆ©ç”¨äº†ç£ç›˜çš„åŠ è½½æ•ˆç‡é—®é¢˜ã€‚



ä¾æ®è®ºæ–‡ï¼ŒDiskANNçš„æ‰§è¡Œæ•ˆç‡å’Œå¬å›ç‡å¥½äºIVFå’ŒHNSWï¼š



![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/c21b76d77c744fa9bd6789ac67c7fb19.png)



# References

[^0.11]: [Harnessing the Power of LLMs in Practice: A Survey on ChatGPT and Beyond](https://arxiv.org/pdf/2304.13712)
[^0.1]: [ä¸€æ–‡è®²æ¸…æ¥šï¼ŒAIã€AGIã€AIGCä¸AIGCã€NLPã€LLMï¼ŒChatGPTç­‰æ¦‚å¿µ](https://juejin.cn/post/7346233811212386345)
[^0.4]: [A Survey of Large Language Models](https://arxiv.org/pdf/2303.18223.pdf)
[^1]: https://en.wikipedia.org/wiki/Prompt_engineering
[^2]: [ RAGåŸå§‹è®ºæ–‡ ](https://arxiv.org/pdf/2005.11401)
[^3]: åŠ‰æ™ºçš“ (Chih-Hao Liu) [66å€‹å¤§å‹èªè¨€æ¨¡å‹LLMç¶“å…¸è«–æ–‡](https://tomohiroliu22.medium.com/66%E5%80%8B%E5%A4%A7%E5%9E%8B%E8%AA%9E%E8%A8%80%E6%A8%A1%E5%9E%8Bllm%E7%B6%93%E5%85%B8%E8%AB%96%E6%96%87-0fcdab74e822)
[^x]: Jonathan Katz pgconfdev2024[Vectors: How to better support a nasty data type](https://www.pgevents.ca/events/pgconfdev2024/sessions/session/1/slides/42/pgconfdev-2024-vectors.pdf)
[^y]: [Vector databases (1): What makes each one different?](https://thedataquarry.com/posts/vector-db-1/)
[^yy]: [å‘é‡æ•°æ®åº“æ€§èƒ½å¯¹æ¯”](https://github.com/erikbern/ann-benchmarks)
[^10]: https://en.wikipedia.org/wiki/Vector_(mathematics_and_physics)
[^11]: https://en.wikipedia.org/wiki/Unit_vector
[^12]: OpenAIè§£é‡Šå•ä½å‘é‡çš„ä½¿ç”¨ https://platform.openai.com/docs/guides/embeddings/frequently-asked-questions
[^13]: Pinecone Natural Language Processing for Semantic Search https://www.pinecone.io/learn/series/nlp/dense-vector-embeddings-nlp/
[^14]: å§šè¿œ [æ¼«è°ˆæ•°å­¦ä¸­çš„å„ç§ç©ºé—´](https://zhuanlan.zhihu.com/p/684643954)
[^15]: https://en.wikipedia.org/wiki/Euclidean_distance
[^16]: https://en.wikipedia.org/wiki/Taxicab_geometry
[^17]: https://en.wikipedia.org/wiki/Minkowski_distance
[^18]: https://en.wikipedia.org/wiki/Sine_and_cosine
[^19]: Jonathan Katz pgconfeu2023 [Vectors are the new JSON](https://www.postgresql.eu/events/pgconfeu2023/sessions/session/4592/slides/435/pgconfeu2023_vectors.pdf) 
[^20]: https://en.wikipedia.org/wiki/Jaccard_index
[^22]: https://en.wikipedia.org/wiki/Hamming_distance
[^23]: Vyacheslav Efimov [Similarity Search, Part 6: Random Projections with LSH Fores](https://towardsdatascience.com/similarity-search-part-6-random-projections-with-lsh-forest-f2e9b31dcc47) â†©
[^24]: earthwjl [Delaunayä¸‰è§’å‰–åˆ†å­¦ä¹ ç¬”è®°](https://www.jianshu.com/p/172749e6116a)
[^25]: https://en.wikipedia.org/wiki/Delaunay_triangulation
[^26]: https://en.wikipedia.org/wiki/Voronoi_diagram
[^40]: å†¯è‹¥èˆª pigsty éæ³•åŠ ç  [å‘é‡æ•°æ®åº“å‡‰äº†å—ï¼Ÿ](https://mp.weixin.qq.com/s/0eBZ4zyX6XjBQO0GqlANnw)
[^50]: Vyacheslav Efimov [Similarity Search, Part 2: Product Quantization](https://towardsdatascience.com/similarity-search-product-quantization-b2a1a6397701)
[^51]: [PQåŸå§‹è®ºæ–‡](https://inria.hal.science/file/index/docid/514462/filename/paper_hal.pdf)
[^52]: Pinecone Faiss Manual https://www.pinecone.io/learn/series/faiss/product-quantization/
[^55]: OpenAIæ¨èä½¿ç”¨vector database https://openai.com/index/chatgpt-plugins/
[^56]: [DiskANNåŸå§‹è®ºæ–‡](https://suhasjs.github.io/files/diskann_neurips19.pdf)
[^57]: DiskANN, A Disk-based ANNS Solution with High Recall and High QPS on Billion-scale Dataset https://milvus.io/blog/2021-09-24-diskann.md
[^60]: https://en.wikipedia.org/wiki/Precision_and_recall
[^65]: [HNSWåŸå§‹è®ºæ–‡](https://arxiv.org/pdf/1603.09320)
[^66]: Vyacheslav Efimov [Similarity Search, Part 4: Hierarchical Navigable Small World (HNSW)](https://towardsdatascience.com/similarity-search-part-4-hierarchical-navigable-small-world-hnsw-2aad4fe87d37)
[^67]: https://www.pinecone.io/learn/series/faiss/vector-indexes/
[^68]: Vyacheslav Efimov [Similarity Search, Part 1: kNN & Inverted File Index](https://towardsdatascience.com/similarity-search-knn-inverted-file-index-7cab80cc0e79)
[^79]: Vyacheslav Efimov [Similarity Search, Part 5: Locality Sensitive Hashing (LSH)](https://towardsdatascience.com/similarity-search-part-5-locality-sensitive-hashing-lsh-76ae4b388203)
[^80]: ç®€ä¹¦ [LSHï¼ˆå±€éƒ¨æ•æ„Ÿå“ˆå¸Œï¼‰ç®—æ³•](https://www.jianshu.com/p/d4368c8f40cb) 
